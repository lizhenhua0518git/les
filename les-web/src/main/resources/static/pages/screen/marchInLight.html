<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<title>排队入场实时信息</title>
	<link rel="stylesheet" type="text/css" href="../layui/css/layui.css" />
</head>

<body>
<div class="wrap marchIn light">
	<div class="header">
		<h1 class="textTitle">排队入场实时信息</h1>
		<p class="subTitle">
			<span class="textSub textTime" id="date">0000-00-00 00:00:00</span>
		</p>
	</div>
	<div class="main">
		<table id="info" lay-filter="test"></table>
	</div>
</div>
<script src="../layui/layui.all.js" charset="UTF-8"></script>
<script src="../js/serverPathConfig.js" charset="UTF-8"></script>
<!--<script src="/iles/pages/js/loginInspect.js" charset="UTF-8"></script>-->
<script type="text/javascript">
	;!function(){
		var $ = layui.jquery
				,util = layui.util
				,table = layui.table;
		var contextPath = config.wmsConfig.contextPath;
		var option = {
		    url : contextPath + 'receiveRecord/listReceiveRecordScreen',
		    type : 'GET',
		    success : function(res) {
		        var data = res.data;
				var tableIns = table.render({
					elem: '#info'
					,loading: false
					,data:data
					// ,contentType: 'application/json'
					// ,headers: {token: '1234567890'}
					,page: false //开启分页
					,limit: data.length
					,cols: [[ //表头
						{field: 'queueCode', title: '排队号',align:'center',width:'15%'}
						,{field: 'supplierName', title: '供应商',align:'center',width:'40%'}
						,{field: 'carCode', title: '车牌号',align:'center',width:'15%'}
						,{field: 'status', title: '状态',align:'center',width:'15%', templet: '#statusTpl'}
						,{field: 'uplodPlat', title: '卸货点',align:'center',width:'15%'}
					]]
					,done: function(res, curr, count){
						console.log(res,curr,count);
						setTimeout(function () {
							// if success after 5s reload
							$.ajax(option);
						},5000)
					}
				});
		    },
		    error : function(res) {
		        layer.alert(res.msg)
		    }
		}
		$.ajax(option);


		setInterval(function () {
			// update head time
			var dateTime = util.toDateString(new Date(),'yyyy-MM-dd HH:mm:ss');
			$('#date').html(dateTime);
		},1000)
	}();
</script>
<script type="text/html" id="statusTpl">
	{{#  if(d.status === '10'){ }}
	<span class="textStatus">可以入场</span>
	{{#  } else { }}
	<span class="textStatus wait">等待入场</span>
	{{#  } }}
</script>
</body>

</html>
