<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>新增项目余料配置</title>
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport"
	content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="stylesheet" href="${ctx}/pages/layui/css/layui.css"  type="text/css" />
<link rel="stylesheet" href="${ctx}/pages/css/layui_extend.css"  media="all">
</head>
<body>
<div class="layui-container" style="padding-top: 20px;">
		<form class="layui-form" action="" lay-filter="projectDeployForm">
			<div class="layui-form-item">
			 	<div class="layui-inline" >
				    <label class="layui-form-label" style="width: 180px">首次统计：项目结束前</label>
				    
				      
			 	</div>
			 	
			 	<div class="layui-inline" >
				     
				    <div class="layui-input-block" style="width: 100px;margin-left:-20px;" >
				      <input type="text" name="firstTotalTime" id="firstTotalTime"  class="layui-input">
				     
				    </div>
				      
			 	</div>
			 	
			 	<div class="layui-inline" >
				     
				     <label class="layui-form-label" style="margin-left:-80px;" >天</label>
			 	</div>
			 	 
			</div>
			<div class="layui-form-item">
                 
                <div class="layui-inline">
                    
                     <div class="layui-inline">
                    <label class="layui-form-label" style="width: 200px">第二次统计：项目结束前</label>
                    
                 </div>
                </div>
                
                <div class="layui-inline" >
				     
				    <div class="layui-input-block" style="width: 100px;margin-left:-20px;" >
				     <input type="text" name="secondTotalTime" id="secondTotalTime"   class="layui-input" >
				     
				    </div>
				      
			 	</div>
			 	
			 	<div class="layui-inline" >
				     
				     <label class="layui-form-label" style="margin-left:-80px;" >天</label>
			 	</div>
            </div>
            <div class="layui-form-item">
                 
                <div class="layui-inline">
                    <label class="layui-form-label" style="width: 200px">第三次统计：项目结束前</label>
                    
                 </div>
                <div class="layui-inline" >
				     
				    <div class="layui-input-block" style="width: 100px;margin-left:-20px;" >
				     <input type="text" class="layui-input" name="threeTotalTime" id="threeTotalTime" placeholder="">
                                                  
				     
				    </div>
				      
			 	</div>
			 	
			 	<div class="layui-inline" >
				     
				     <label class="layui-form-label" style="margin-left:-80px;" >天</label>
			 	</div>
              </div>
           
			 <div class="layui-form-item">
			    <div class="layui-input-block">
			      <button class="layui-btn" lay-submit="" lay-filter="projectDeploySubit">立即提交</button>
			     <button   class="layui-btn" onclik="initData()">重置</button>
			    </div>
			  </div>
			    <input type="text" hidden="true"  name="id">
		</form>
	</div>
	<script src="${ctx}/pages/layui/layui.all.js" charset="UTF-8"></script>
	<script type="text/javascript">
	var $ = layui.$;
	var layer = layui.layer;
	var form = layui.form
	 
     initData();
	layui.use(['form', 'layedit'], function(){
		form.verify({
			 
			 
			 firstTotalTime:function(value){
				  
			      if(!isNumber(value)){
			    	  return '首次统计为数字';
			      }
			       
			},
			secondTotalTime:function(value){
				  
			      if(!isNumber(value)){
			    	  return '第二统计为数字';
			      }
			       
			},
			threeTotalTime:function(value){
				  
			      if(!isNumber(value)){
			    	  return '第三统计为数字';
			      }
			       
			}
  
	 
			
		  });
		  //监听提交
		  form.on('submit(projectDeploySubit)', function(data){
			saveDict(data);
			return false;
		 });
	});
	
	function isNumber(value) {         //验证是否为数字
	    var patrn = /^(-)?\d+(\.\d+)?$/;
	      if (patrn.exec(value) == null || value == "") {
	          return false
	      } else {
	         return true
	     }
	  }
	function saveDict(data){
		var option = {
	    	url:'${ctx}/projectDeploy/modify',
	    	data:JSON.stringify(data.field),
	    	type:'POST',
	    	contentType:'application/json',
	    	success:function(data){
	    		if(data.code==0){
	    			var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
	    			parent.layer.close(index);  // 关闭layer
	    			parent.table.reload('projectDeployInfoTabId');
	    		}else{
	    			layer.alert(data.data);
	    		}
	    	},error:function(data){
	    		layer.alert(data.msg)
	    	}
	    }
	    $.ajax(option); 
	}

	
		//初始化表单数据
		function initData(){
		    var oldData = parent.oldData;
		    var formData =  eval('('+JSON.stringify(oldData)+')');
		        form.val('projectDeployForm',formData);
		        form.render('select');
		     
		}
		 
		
	</script>
</body>
</html>