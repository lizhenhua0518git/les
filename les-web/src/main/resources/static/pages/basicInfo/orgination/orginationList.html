<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport"
	content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="stylesheet" href="/iles/pages/layui/css/layui.css"  media="all">
<link rel="stylesheet" href="/iles/pages/css/layui_extend.css"  media="all">
<title></title>
</head>
<body>
 <div id="bodyDiv">

</div>
	<div class="layui-fluid">
		<table class="layui-hide" id="orgTab" lay-filter="orgTabF"></table>
	</div>

	<script src="/iles/pages/layui/layui.all.js" charset="UTF-8"></script>
	<script src="/iles/pages/js/serverPathConfig.js" charset="UTF-8"></script>
	<script src="/iles/pages/layui/lay/modules/tableFilter.js" charset="UTF-8"></script>
	<script src="/iles/pages/js/loginInspect.js"></script>
<script src="/iles/pages/layui/lay/modules/treeGrid.js" charset="UTF-8"></script>
	<script type="text/html" id="bodyTpl"></script>
	<script type="text/javascript">
	var parentId = parent.parentId;
	var contextPath = config.basicInfoConfig.contextPath;
	layui.use(['element','jquery','laydate','form','table'],function(){
		var $ = layui.$;
		var laydate = layui.laydate;
		var table = layui.table;

		laydate.render({
		  elem: '#datemin' //指定元素
		  ,type:'date'
		});
		laydate.render({
		   elem: '#datemax' //指定元素
		   ,type:'date'
		});

		//初始化表格开始
	  	table.render({
	  		elem: '#orgTab'
	  		,id:'orgTabId'
	    	,url:contextPath+'orgnization/orgnizationList'
	    	,cols: [[
	    	{type:'checkbox'}
		    //,{field:'id', width:80, title: 'ID', sort: false,style:'display:none'}
		    ,{field:'orgCode', width:'30%', title: '组织编号', sort: true}
		    ,{field:'orgName', width:'30%', title: '组织名称', sort: true}
		    ,{field:'orgType', width:'29%', title: '组织类型', sort: true}
		    ,{field:'status', title: '状态', minWidth: 100}
	    	]]
	    	,page: {theme: '#008155'}
	    	,height: 'full-95'
	    	,even:true
	    	,where:{"parentId":parentId}
	    	,done:function(res,page,count){//列表数据回调函数
	    		//组织类型数据处理
	    		$("[data-field='orgType']").children().each(function(){
	    			console.log($(this).text());
	    			if($(this).text()=='0'){
	    				$(this).text("公司总部");
	    			}else if($(this).text()=='1'){
	    				$(this).text("分公司");
	    			}else if($(this).text()=='2'){
	    				$(this).text("部门");
	    			}else if($(this).text()=='3'){
	    				$(this).text("工厂");
	    			}else if($(this).text()=='4'){
	    				$(this).text("仓库");
	    			}
	    		});
	    		//状态数据处理
	    		$("[data-field='status']").children().each(function(){
	    			console.log($(this).text());
	    			if($(this).text()=='0'){
	    				$(this).text("禁用");
	    			}else if($(this).text()=='1'){
	    				$(this).text("启用");
	    			}
	    		});
	    	}
	  	});
	  	table.on('sort(orgTabF)', function (obj) {
			var sortColums;
			if(obj.field=="orgCode"){
				sortColums = "org_code "+obj.type;
			}else if(obj.field=="orgName"){
				sortColums = "org_name "+obj.type;
			}else if(obj.field=="orgType"){
				sortColums = "org_type "+obj.type;
			}else if(obj.field=="status"){
				sortColums = "status "+obj.type;
			}
		    //执行重载
		    table.reload('orgTabId', {
		        where:{
		        	"parentId": parentId
		           ,"sortColums":sortColums
		        }
		    });
		});
	});

	</script>
</body>
</html>
