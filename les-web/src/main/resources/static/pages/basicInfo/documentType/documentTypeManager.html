<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="Content-Type" content="charset=UTF-8">
<meta name="viewport"
    content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<title>单据类型管理</title>
<link rel="stylesheet" href="/iles/pages/layui/css/layui.css"  type="text/css" />
<link rel="stylesheet" href="/iles/pages/css/layui_extend.css" type="text/css" />
</head>

<body id="bodyDiv">


<script type="text/html" id="bodyTpl">
<div class="layui-fluid">
	<div class="layui-row layui-form">
		<div class="layui-col-md2">
			 	<label class="layui-form-label">单据类型编码</label>
			 	 <div class="layui-input-inline">
			      <input type="text" id="documentTypeCode_search" class="layui-input">
			    </div>
		</div>
		<div class="layui-col-md2">
			 	<label class="layui-form-label">单据类型名称</label>
			 	 <div class="layui-input-inline">
			      <input type="text" id="documentTypeName_search" class="layui-input">
			    </div>
		</div>
		<div class="layui-col-md2">
			 	<label class="layui-form-label">业务类型</label>
			 	 <div class="layui-input-inline">
			        <select  id="businessType_search">
			        	<option value="">请选择</option>
			      	</select>
			    </div>
		</div>
		<div class="layui-col-md2">&nbsp;</div>
		<div class="layui-col-md2">&nbsp;</div>
		<div class="layui-col-md2">
			<div class="layui-btn-container" style="text-align: right;">
				{{# if(d.search==null || d.search=="true"){ }}
             	 	<button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="search" id="search" type="button"><i class="layui-icon layui-icon-search"></i>查询</button>
              		<button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="reset" id="reset" type="button"><i class="layui-icon layui-icon-reset"></i>重置</button>
              	{{# } }}
			</div>
		</div>
	</div>
</div>
<div class="layui-fluid-table">
<div class="layui-row layui-form" style="margin-bottom: 0">
		<div class="layui-btn-container" style="text-align: left;">
              {{# if(d.add==null || d.add=="true"){ }}
              <button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="add" data-type="auto" type="button"><i class="layui-icon  layui-icon-add-circle"></i>新增</button>
              {{# } }}
              {{# if(d.edit==null || d.edit=="true"){ }}
              <button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="edit" type="button"><i class="layui-icon layui-icon-edit"></i>修改</button>
              {{# } }}
              {{# if(d.del==null || d.del=="true"){ }}
              <button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="del" type="button"><i class="layui-icon layui-icon-delete"></i>删除</button>
              {{# } }}
              {{# if(d.export==null || d.export=="true"){ }}
              <button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="export" type="button"><i class="layui-icon layui-icon-export"></i>导出</button>
         	  {{# } }}
         </div>
</div>
<table class="layui-hide" id="documentTypeTab" lay-filter="documentTypeTabF"></table>
</div>
</script>
<script src="/iles/pages/layui/layui.all.js" charset="UTF-8"></script>
<script src="/iles/pages/js/serverPathConfig.js" charset="UTF-8"></script>
<script src="/iles/pages/js/loginInspect.js" charset="UTF-8"></script>
<script src="/iles/pages/js/common/dictSelelct.js" charset="UTF-8"></script>
<script type="text/javascript">
var table = layui.table;
var contextPath = config.basicInfoConfig.contextPath;
var oldData;
var form = layui.form;
var storage = window.localStorage;
var token = storage.token;
var active = {
		add:function(othis){
			var type = othis.data('type');
  			layer.open({
	        type: 2
	        ,title:'新增单据类型'
	        ,maxmin:false
	        ,area: ['460px', '450px']
	        ,offset: type
	        ,id: 'documentTypeadd'+type //防止重复弹出
	        ,content: '/iles/pages/basicInfo/documentType/addDocumentType.html'
	        ,shade: 0 //不显示遮罩
	        ,yes: function(){
	          layer.closeAll();
	        }
	      });
		},
		edit:function(othis){
			var checkStatus = table.checkStatus('documentTypeTabId');
 				oldData = checkStatus.data;
			if(oldData.length<=0){
				layer.alert('请选择要编辑的行！',{icon: 2});
 					return ;
			}else if(oldData.length >1){
 					layer.alert('编辑不能超过多行！',{icon: 2});
 					return ;
 				}
			var type = othis.data('type');
  			layer.open({
		        type: 2
		        ,title:'编辑单据类型'
		        ,maxmin:false
		        ,area: ['460px', '450px']
		        ,offset: type
		        ,id: 'documentTypeEdit'+type //防止重复弹出
		        ,content: '/iles/pages/basicInfo/documentType/editDocumentType.html'
		        ,shade: 0 //不显示遮罩
		        ,yes: function(){
		          layer.closeAll();
		        }
	     	 });
		},del:function(othis){
			var checkStatus = table.checkStatus('documentTypeTabId');
 				oldData = checkStatus.data;
			if(oldData.length<=0){
				layer.alert('请选择要删除的行！',{icon: 2});
 					return ;
			}
			var idarrys = new Array();
			for(var i=0;i<oldData.length;i++){
				idarrys.push(oldData[i].id);
			}
			layer.confirm('确定删除该条用户信息?', {icon: 3, title:'提示'}, function(index){
	  			  //do something
	  			  var option ={
						url: contextPath +'documentType/deleteDocumentType',
						type:'POST',
						contentType: "application/json",
						dataType:'json',
						data:JSON.stringify(idarrys),
						success:function(data){
							if(data.code==0){
								layer.alert("删除成功");
								table.reload('documentTypeTabId');
							}
						},error:function(data){
							layer.alert(data.msg);
						}
					}
					$.ajax(option);
	  			  layer.close(index);
	  			});
		},search:function(othis){
			var documentTypeCode = $('#documentTypeCode_search');
			var documentTypeName = $('#documentTypeName_search');
			var businessType = $('#businessType_search');
		      //执行重载
		      table.reload('documentTypeTabId', {
		        where:{
		        	documentCode: documentTypeCode.val()
		           ,documentName:documentTypeName.val()
		           ,businessType:businessType.val()
		        }
		        ,page:{"curr":1}
		      });
		},reset:function(othis){
			$('#documentTypeCode_search').val("");
			$('#documentTypeName_search').val("");
			$('#businessType_search').val("");
			form.render("select");
		},export:function(othis){
			var documentTypeCode = $('#documentTypeCode_search').val();
			var documentTypeName = $('#documentTypeName_search').val();
			var businessType = $('#businessType_search').val();
			var params = "documentCode="+documentTypeCode+"&documentName="+documentTypeName
						 +"&token="+token;
			if(businessType!=''){
				params = params + "&businessType="+businessType;
			}
			window.open(contextPath+"documentType/exportDocumentType?"+params);
		}
};
function loadding(){
	table.render({
		elem:'#documentTypeTab',
		id:'documentTypeTabId',
		url: contextPath +'documentType/listDocumentType',
		cols:[[
		{type:'checkbox'},
		{type:'numbers',title:'序号',width: 60},
		{field:'documentCode',title:'单据类型编码'},
		{field:'documentName',title:'单据类型名称'},
		{field:'businessTypeStr', title: '业务类型'},
		{field:'sourceOfDocumentStr',title: '来源'},
		{field:'statusStr', title: '状态'},
		{field:'createrName', title: '创建人'},
		{field:'createTime', title: '创建时间'},
		{field:'modifierName', title: '修改人'},
		{field:'modifiedTime', title: '修改时间'},
		]],
		page: {theme: '#008155'},
   		even:true
	});
	$('.layui-btn-container button').on('click', function(){
	    var othis = $(this), method = othis.data('method');
	    active[method] ? active[method].call(this, othis) : '';
  	});
	queryDictItem('business_type','businessType_search','');
	form.render("select");
}
</script>
</body>

</html>
