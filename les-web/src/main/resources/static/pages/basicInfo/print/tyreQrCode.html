<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<title>打印</title>
	<link rel="stylesheet" href="/iles/pages/layui/css/layui.css"
		  type="text/css" />
	<link rel="stylesheet" href="/iles/pages/css/print/tyreQrCode.css"
		  type="text/css" />



</head>
<body>

<!-- 你的HTML代码 -->
<div class="qrCode" id="mainHtml">
	<div class="card">
		<div class="cardHead">
			<span class="textHead">空中输送线轮胎二维码</span>
		</div>
		<div class="cardBody">
			<div class="rightWrap">
				<img src="/iles/pages/img/print/qrCode.jpg" width="200" height="200"  id="img">

			</div>
			<div class="leftWrap">
				<div class="layui-form" action="">
					<div class="layui-form-item">
						<label class="layui-form-label">订单名称</label>
						<div class="layui-input-block">
							<input type="text" id="title" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item">
						<label class="layui-form-label">所属产线</label>
						<div class="layui-input-block">
							<select id="line" lay-verify="required" lay-filter="lineType" >
								<option value=""></option>
								<option value="A">总装A线（A）</option>
								<option value="B">总装B线（B）</option>
								<option value="C">总装C线（C）</option>
								<option value="D">总装D线（D）</option>
							</select>
						</div>
					</div>
					<div class="layui-form-item">
						<label class="layui-form-label">轮胎性质</label>
						<div class="layui-input-block">
							<select id="nature" lay-verify="required" lay-filter="natureType" >
								<option value=""></option>
								<option value="Y">含胎压（Y）</option>
								<option value="N">不含胎压（N）</option>

							</select>
						</div>
					</div>
					<div class="layui-form-item">
						<label class="layui-form-label">安装位置</label>
						<div class="layui-input-block" >
							<select id="position" lay-verify="required"  lay-filter="positionType" >
								<option value=""></option>
								<option value="L">左（L）</option>
								<option value="R">右（R）</option>

							</select>
						</div>
					</div>
					<div class="layui-form-item">
						<label class="layui-form-label">轮胎序号</label>
						<div class="layui-input-block" >
							<select id="index" lay-verify="required" lay-filter="indexType"  >
								<option value=""></option>
								<option value="01">01</option>
								<option value="03">03</option>
								<option value="05">05</option>
								<option value="07">07</option>
							</select>
						</div>
					</div>
					<div class="layui-form-item">
						<label class="layui-form-label">轮胎编码</label>
						<div class="layui-input-block">
							<input type="text" id="code" autocomplete="off" class="layui-input">
						</div>
					</div>
				</div>
			</div>

		</div>
	</div>
</div>
<div class="layui-btn-container nav-" style="text-align: left;">

	<button class="layui-btn layui-btn-normal layui-btn-sm"  onclick="createQrcode()" id="printInfo" type="button"><i class="layui-icon layui-icon-print"></i>打印</button>


</div>
<div id="outDiv" style="display: none"><div id='bcTarget' style='float:right;'></div></div>
<!--打印内容-->
<div style="display: none">
	<div id="printContent" class="qrCode"></div>
</div>
<div id="codeDiv" style="display:none">
	<div id="qrcodes" style='float: right;width:140px;height:140px;margin-top:30px;position:absoulte;margin-right: 30px'></div>
</div>

<script src="/iles/pages/js/printer/jquery.min.js"></script>
<script src="/iles/pages/js/qrcode/jquery-qrcode-0.14.0.min.js"></script>
<script src="/iles/pages/js/printer/jquery-migrate-1.2.1.min.js"></script>
<script src="/iles/pages/js/printer/jquery.jqprint-0.3.js"></script>

<script src="/iles/pages/js/barcode/jquery-barcode.js"></script>
<script src="/iles/pages/layui/layui.all.js" charset="UTF-8"></script>
<script>
	var jquery$ = $;
	var layer = layui.layer;
	function createQrcode(){

		jquery$("#bcTarget").empty().barcode("1", "code128",{barWidth:2, barHeight:70,showHRI:true});

		//生成二维码
		var newStr =$("#code").val();
		jquery$("#qrcodes").empty().qrcode({
			render: "canvas", //canvas方式
			width: "30mm", //宽度
			height:"30mm", //高度
			text: newStr //显示内容
		});
		//二维码canvas转img
		var qrcodeImgSrc = $("canvas")[0].toDataURL('image/jpg');

		var title = $("#title").val();
		var line = $("#line").val();
		var nature = $("#nature").val();
		var position = $("#position").val();
		var index = $("#index").val();
		var code = $("#code").val();
        if(title==""){
			layer.alert('订单名称为空');
			return  ;
		}
		if(line==""){
			layer.alert('所属产线为空');
			return  ;
		}
		if(nature==""){
			layer.alert('轮胎性质为空');
			return  ;
		}
		if(position==""){
			layer.alert('安装位置为空');
			return  ;
		}
		if(index==""){
			layer.alert('轮胎序号为空');
			return  ;
		}
		
		var  html = '<div class="card1" style="width:130mm;hight:120mm">' +
				'<div class="cardHead1">' +
				'<span class="textHead1">空中输送线轮胎二维码</span>' +
				'</div>' +
				'<div class="cardBody1">' +
				'<div class="rightWrap">' +
				'<img src="'+qrcodeImgSrc+'" id="img">' +
				'</div>' +
				'<div class="leftWrap1" >' +
				'<div class="layui-form" action="">' +
				'<div class="layui-form-item">' +
				'<label class="layui-form-label" style="">订单</label>' +
				'<div class="layui-input-block">' +
				'<input type="text"  style="width:280px;" value="'+title+'" class="layui-input">' +
				'</div>' +
				'</div>' +
				'<div class="layui-form-item">' +
				'<label class="layui-form-label">产线</label>' +
				'<div class="layui-input-block">' +
				'<input type="text" name="title" value="'+line+'" class="layui-input">' +
				'</div>' +
				'</div>' +
				'<div class="layui-form-item">' +
				'<label class="layui-form-label">性质</label>' +
				'<div class="layui-input-block">' +
				'<input type="text" name="title" value="'+nature+'" class="layui-input">' +
				'</select>' +
				'</div>' +
				'</div>' +
				'<div class="layui-form-item">' +
				'<label class="layui-form-label">位置</label>' +
				'<div class="layui-input-block">' +
				'<input type="text" name="title" value="'+position+'" class="layui-input">' +
				'</div>' +
				'</div>' +
				'<div class="layui-form-item">' +
				'<label class="layui-form-label">序号</label>' +
				'<div class="layui-input-block">' +
				'<input type="text" name="title" value="'+index+'" class="layui-input">' +
				'</div>' +
				'</div>' +
				'<div class="layui-form-item">' +
				'<label class="layui-form-label">编码</label>' +
				'<div class="layui-input-block">' +
				'<input type="text" name="code" value="'+code+'" class="layui-input">' +
				'</div>' +
				'</div>' +
				'</div>' +
				'</div>' +
				'</div>' +
				'</div>';

		jquery$("#printContent").empty().append(html).jqprint();

	}
	layui.use(['form'], function() {
		var form=layui.form;
		form.on('select(lineType)', function(data){
			var code = $("#code").val();
			if(code!=""){
				var line = $("#line").val();
				var nature = $("#nature").val();
				var position = $("#position").val();
				var index = $("#index").val();
				$("#code").val(line+"-"+nature+"-"+position+"-"+index);
			}
		});

		form.on('select(natureType)', function(data){
			var code = $("#code").val();
			if(code!=""){
				var line = $("#line").val();
				var nature = $("#nature").val();
				var position = $("#position").val();
				var index = $("#index").val();
				$("#code").val(line+"-"+nature+"-"+position+"-"+index);
			}
		});

		form.on('select(positionType)', function(data){
			var position = $("#position").val();
			var htmlL =
					'<option value=""></option>' +
					'<option value="01">01</option>' +
					'<option value="03">03</option>' +
					'<option value="05">05</option>' +
					'<option value="07">07</option>';
			var htmlR=
					'<option value=""></option>' +
					'<option value="02">02</option>' +
					'<option value="04">04</option>' +
					'<option value="06">06</option>';

			if(position=='L'){
				$("#index").html(htmlL);
			}else  if(position=='R'){
				$("#index").html(htmlR);
			}else{
				$("#index").html(htmlL);
			}

			var code = $("#code").val();
			if(code!=""){
				var line = $("#line").val();
				var nature = $("#nature").val();
				var position = $("#position").val();
				var index = $("#index").val();
				$("#code").val(line+"-"+nature+"-"+position+"-"+index);
			}
			form.render("select");
		});

		form.on('select(indexType)', function(data){
			var line = $("#line").val();
			var nature = $("#nature").val();
			var position = $("#position").val();
			var index = $("#index").val();
			var code = $("#code").val();

			if(line==""){
				layer.alert('所属产线为空');
				return  ;
			}
			if(nature==""){
				layer.alert('轮胎性质为空');
				return  ;
			}
			if(position==""){
				layer.alert('安装位置为空');
				return  ;
			}
			if(index==""){
				layer.alert('轮胎序号为空');
				return  ;
			}


			$("#code").val(line+"-"+nature+"-"+position+"-"+index);
		});

	});



</script>
</body>
</html>
