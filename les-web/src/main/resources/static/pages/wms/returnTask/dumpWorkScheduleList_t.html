<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="renderer" content="webkit|ie-comp|ie-stand">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta http-equiv="Content-Type" content="charset=UTF-8">
	<meta name="viewport"
		  content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<meta http-equiv="Cache-Control" content="no-siteapp" />
	<link rel="stylesheet" href="/iles/pages/layui/css/layui.css"  type="text/css" />
	<link rel="stylesheet" href="/iles/pages/css/layui_extend.css"  media="all">
	<link rel="stylesheet" href="/iles/pages/layui/css/modules/layer/default/layer.css"  type="text/css" />
	<link rel="stylesheet" href="/iles/pages/layui/css/formSelects-v4.css" />
	<title>退料转储作业管理</title>
</head>
<div id="bodyDiv">

</div>
<script src="/iles/pages/lib/jquery-qrcode-0.14.0/jquery.min.js"></script>
<script src="/iles/pages/lib/jquery-qrcode-0.14.0/jquery-qrcode-0.14.0.min.js"></script>
<script src="/iles/pages/lib/jquery-barcode/jquery-migrate-1.2.1.min.js"></script>
<script src="/iles/pages/lib/jquery-barcode/jquery.jqprint-0.3.js"></script>
<script type="text/javascript">var jquery$ = $;</script>
<script src="/iles/pages/lib/jquery-barcode/jquery-barcode.js"></script>

<script src="/iles/pages/layui/layui.all.js" charset="UTF-8"></script>
<script src="/iles/pages/layui/lay/modules/layer.js" charset="UTF-8"></script>
<script src="/iles/pages/js/serverPathConfig.js" charset="UTF-8"></script>
<script src="/iles/pages/js/loginInspect.js" charset="UTF-8"></script>
<script src="/iles/pages/js/common/warehouseSelect.js" charset="UTF-8"></script>
<script type="text/html" id="bodyTpl">
	<div class="layui-fluid">
		<div class="layui-row layui-form">
			<div class="layui-col-md3">
				<label class="layui-form-label">转储日期:</label>
				<div class="layui-input-block layui-form">
					<input type="text" class="layui-input" name="getTime" id="getTime" placeholder="请选择转储日期">
				</div>
			</div>
			<div class="layui-col-md3">
				<label class="layui-form-label">物料号:</label>
				<div class="layui-input-block">
					<input type="text" name="materialCode" id="materialCode" class="layui-input" placeholder="请输入物料号">
				</div>
			</div>
			<div class="layui-col-md3">
				<label class="layui-form-label">物料描述:</label>
				<div class="layui-input-block">
					<input type="text" name="materialDesc" id="materialDesc" class="layui-input" placeholder="请输入物料描述">
				</div>
			</div>
			<div class="layui-col-md3">
				<label class="layui-form-label">sap管理工:</label>
				<div class="layui-input-block">
					<input type="text" name="sapManager" id="sapManager" class="layui-input" placeholder="请输入质检sap管理工">
				</div>
			</div>
		</div>
		<div class="layui-row layui-form">
			<div class="layui-col-md3">
				<label class="layui-form-label">收货凭证号:</label>
				<div class="layui-input-block">
					<input type="text" name="receiptVoucherNo" id="receiptVoucherNo" class="layui-input" placeholder="请输入收货凭证号">
				</div>
			</div>
			<div class="layui-col-md3">
				<label class="layui-form-label">转储单号:</label>
				<div class="layui-input-block">
					<input type="text" name="dumpOrderCode" id="dumpOrderCode" class="layui-input" placeholder="请输入转储单号">
				</div>
			</div>
			<div class="layui-col-md3">
				<label class="layui-form-label">目的仓位:</label>
				<div class="layui-input-block">
					<input type="text" name="storageBinId" id="storageBinId" class="layui-input" placeholder="请输入目的仓位">
				</div>
			</div>
			<div class="layui-col-md3">
				<label class="layui-form-label">是否合格:</label>
				<div class="layui-input-block">
					<select id="qualifiedStatus" name="qualifiedStatus">
						<option value=""></option>
						<option value="0">不合格</option>
						<option value="1">合格</option>
						<option value="2">部分合格</option>
					</select>
				</div>
			</div>
		</div>
		<div class="layui-row layui-form">
			<div class="layui-col-md3">
				<label class="layui-form-label">转储状态:</label>
				<div class="layui-input-block layui-form">
					<select id="dumpStatus" name="dumpStatus">
						<option value=""></option>
					</select>
				</div>
			</div>
			<div class="layui-col-md3">
				<label class="layui-form-label">仓库编号:</label>
				<div class="layui-input-block">
					<select id="warehouseCode" xm-select="select1" xm-select-show-count="1">
						<option value="">请选择</option>
					</select>
				</div>
			</div>
			<div class="layui-col-md3">&nbsp;</div>
			<!-- 按钮区域begin -->
			<div class="layui-col-md5">
				<div class="layui-btn-container" style="text-align: right;">
					<button class="layui-btn layui-btn-normal layui-btn-sm" data-method="search" type="button"><i class="layui-icon layui-icon-search"></i>查询</button>
					<button class="layui-btn layui-btn-normal layui-btn-sm" data-method="reset" type="button"><i class="layui-icon-reset"></i>重置</button>
					<button class="layui-btn layui-btn-normal layui-btn-sm" data-method="export" type="button"><i class="layui-icon layui-icon-export"></i>导出</button>
					<button class="layui-btn layui-btn-normal layui-btn-sm" data-method="printDataShelf" type="button"><i class="mine-icon icon-print"></i>货架打印</button>
					<button class="layui-btn layui-btn-normal layui-btn-sm" data-method="printDataFloor" type="button"><i class="mine-icon icon-print"></i>地堆打印</button>
				</div>
			</div>
			<!-- 按钮区域end -->
		</div>
	</div>
	<table id="scheduleTab" lay-filter="scheduleTabF"></table>
</script>
<script type="text/javascript">
	//获取运营决策页面带来的数据
	var arrivalId = getQueryVariable("arrivalId");
	function getQueryVariable(variable){
		var query = window.location.search.substring(1);
		var vars = query.split("&");
		for (var i=0;i<vars.length;i++) {
			var pair = vars[i].split("=");
			if(pair[0] == variable){
				return pair[1];
			}
		}
		return "";
	}

	var layer = layui.layer;
	var table = layui.table;
	var form = layui.form;
	var wmsContextPath = config.wmsConfig.contextPath;
	var baseContextPath = config.basicInfoConfig.contextPath;
	var oldData;

	var active = {
		search:function(othis){
			//执行重载
			var storageLocation = layui.formSelects.value('select1', 'storagelocationStr');
			table.reload('scheduleTabId', {
				where:{
					inspectAreaId : $('#inspectAreaId').val(),
					startTime : $('#getTime').val().substring(0,20),
					endTime : $('#getTime').val().substring(22),
					materialCode : $('#materialCode').val(),
					materialDesc : $('#materialDesc').val(),
					sapManager : $("#sapManager").val(),
					receiptVoucherNo : $("#receiptVoucherNo").val(),
					inspectBatchNo : $("#inspectBatchNo").val(),
					inspectType : $("#inspectType").val(),
					dumpOrderCode : $("#dumpOrderCode").val(),
					storageBinId : $("#storageBinId").val(),
					qualifiedStatus : $("#qualifiedStatus").val(),
					dumpStatus : $('#dumpStatus').val(),
					urgentStatus : $('#urgentStatus').val(),
					storageLocation:storageLocation,
				},
				page : {
					"curr" : 1
				}
			});
		},
		reset:function(othis){
			$('#inspectAreaId').val("");
			$('#getTime').val("");
			$('#materialCode').val('');
			$('#materialDesc').val('');
			$('#sapManager').val('');
			$('#receiptVoucherNo').val('');
			$('#inspectBatchNo').val('');
			$('#inspectType').val('');
			$('#dumpOrderCode').val('');
			$('#storageBinId').val('');
			$('#qualifiedStatus').val('');
			$('#dumpStatus').val('');
			$('#urgentStatus').val('');
			form.render("select");
		},
		export:function(othis){
			var storageLocation = layui.formSelects.value('select1', 'storagelocationStr');
			var inspectAreaId = $('#inspectAreaId').val();
			var startTime = $('#getTime').val().substring(0,20);
			var endTime = $('#getTime').val().substring(22);
			var materialCode = $('#materialCode').val();
			var materialDesc = $('#materialDesc').val();
			var sapManager = $("#sapManager").val();
			var receiptVoucherNo = $("#receiptVoucherNo").val();
			var inspectBatchNo = $("#inspectBatchNo").val();
			var inspectType = $("#inspectType").val();
			var dumpOrderCode = $('#dumpOrderCode').val();
			var storageBinId = $('#storageBinId').val();
			var qualifiedStatus = $('#qualifiedStatus').val();
			var dumpStatus = $('#dumpStatus').val();
			var urgentStatus = $('#urgentStatus').val();
			var token = window.localStorage.token;
			var params = "startTime="+startTime+"&endTime="+endTime+"&materialCode="+materialCode
					+"&materialDesc="+materialDesc+"&sapManager="+sapManager+"&receiptVoucherNo="+receiptVoucherNo+"&dumpOrderCode="+dumpOrderCode+"&storageBinId="+storageBinId+"&qualifiedStatus="+qualifiedStatus
					+"&dumpStatus="+dumpStatus+"&storageLocation"+storageLocation+"&token="+token;
			window.open(wmsContextPath+"dumpWork/exportExcelT?"+params);
		} ,
		printDataShelf:function(othis){		//货架打印
			var checkStatus = table.checkStatus('scheduleTabId');
			oldData = checkStatus.data;
			var length = oldData.length;
			if(length<=0){
				layer.alert('请选择要打印的行！',{icon: 2});
				return ;
			}else{
				$.ajax({
					type: 'POST',
					async: false,
					url:wmsContextPath+"dumpWork/printDetailShelfDataT",
					dataType: "json",
					data:JSON.stringify(oldData),
					contentType : 'application/json',
					success: function(res){
						if(res.code==0){
							var list = res.data;
							var str = "";
							if(list&&list.length>0){
								for(var i=0;i<list.length;i++){

									//生成二维码
									var newStr = list[i].materialCode+"\n"+ "载具："+list[i].carrierCode+"\n"+ "目的仓位："+list[i].storageBinId+"\n"+ "转储单号："+list[i].dumpOrderCode+"\n"+ "物料编号："+list[i].materialCode+"\n"+list[i].ufrId;
									jquery$("#code").empty().qrcode({
										render: "canvas", //canvas方式
										width: 120, //宽度
										height:120, //高度
										text: newStr //显示内容
									});
									//二维码暂存给img
									var qrcodeImgSrc = $("canvas")[0].toDataURL('image/jpg');//二维码canvas转img
									var img = "<img src='"+qrcodeImgSrc+"' alt='' id='codeImg' style='float:right;width:130px;height:130px;margin-right:50px;'>";
									str += "<div class='main' style='margin:0 auto; padding:0px 10px 10px 10px; width:100%; height:65%; background: #fff;line-height:40px;font-family: 'Microsoft YaHei', 'Open Sans', sans-serif;'>"+
											"<div class='top' style='height:130px;'>"+
											img+
											"<h3 style='font-size:35px; margin:0; text-align:center;margin-left:135px'>物料标签</h3>"+
											"<span style='font-size:18px;'>载具："+list[i].carrierCode+"</span>"+
											"<div><span style='font-size:18px;'>目的仓位：</span><span style='font-size:30px'>"+list[i].storageBinId+"</span></div>"+
											"</div>"+
											"<div style='height:38px'>"+
											"<span style='font-size:18px;'>物料描述：</span><span style='font-size:18px;margin-right:50px;'>"+list[i].materialDesc+"</span>"+
											"</div>"+
											/*  "<div style='height:38px'>"+
                                                 "<span style='font-size:18px;'>序列号：</span><span style='font-size:18px;margin-right:50px;width:150px'>"+list[i].serialCode+"</span>"+
                                             "</div>"+ */
											"<div class='bottom'>"+
											"<div style='float: left;display: block;width: 65%;'>"+
											"<div style='height:38px'><span style='font-size:18px;'>转储单号：</span><span style='font-size:30px'>"+list[i].dumpOrderCode+"</span></div>"+
											"<div style='height:38px'><span style='font-size:18px;'>物料号：</span><span style='font-size:30px'>"+list[i].materialCode+"</span></div>"+
											/* 					    							  			  "<div style='height:38px'><span style='font-size:18px;'>检验批号：</span><span style='font-size:18px;margin-right:50px;width:150px'>"+list[i].inspectBatchNo+"</span></div>"+ */
											"<div style='height:38px'><span style='font-size:18px;'>工厂：</span><span style='font-size:18px;margin-right:50px;'>"+list[i].factory+"</span></div>"+
											"<div style='height:38px'><span style='font-size:18px;'>数量/单位：</span><span style='font-size:18px;margin-right:50px;width:150px'>"+list[i].accountCount+'/'+list[i].materialUnit+"</span></div>"+
											"<div style='height:38px'><span style='font-size:18px;'>供应商名称：</span><span style='font-size:18px;margin-right:50px;'>"+list[i].supplierName+"</span></div>"+
											/* 					    										  "<div style='height:38px'><span style='font-size:18px;'>制造商：</span><span style='font-size:18px;'>"+list[i].manufacturer+"</span></div>"+ */
											"</div>"+
											"<div style='float: left;display: block;width: 35%;'>"+
											"<div style='height:38px'><span style='font-size:18px;'>TO行项目：</span><span style='font-size:18px;margin-right:20px;width:180px'>"+list[i].arrivalItemNo+"</span></div>"+
											"<div style='height:38px'><span style='font-size:18px;'>批次号：</span><span style='font-size:18px;margin-right:20px;width:180px'>"+list[i].batchNo+"</span></div>"+
											"<div style='height:38px'><span style='font-size:18px;'>目的仓储类型：</span><span style='font-size:18px;margin-right:10px;width:240px'>"+list[i].storageType+"</span></div>"+
											/* "<div style='height:38px'><span style='font-size:18px;'>源仓位数量/单位：</span><span style='font-size:18px;margin-right:20px;width:150px'>"+list[i].accountCount+'/'+list[i].materialUnit+"</span></div>"+ */
											/* "<div style='height:38px'><span style='font-size:18px;'>保质期：</span><span style='font-size:18px;margin-right:50px;width:150px'>"+list[i].expireDate+"</span></div>"+
                                            "<div style='height:38px'><span style='font-size:18px;'>入库日期：</span><span style='font-size:18px;'>"+list[i].passTime+"</span></div>"+ */
											"</div>"+
											"<div style='clear:both'></div>"+
											"</div>"+
											"</div>"+
											"<div style='page-break-after:always;'></div>";
								}
								jquery$("#printContent").empty().append(str).jqprint();
							}else{
								layer.msg("无数据");
								return false;
							}
						}
					}
				});
			}
		},
		printDataFloor:function(othis){		//地堆打印
			var checkStatus = table.checkStatus('scheduleTabId');
			var data = checkStatus.data;
			var length = data.length;
			if(length<=0){
				layer.alert('请选择要打印的行！',{icon: 2});
				return ;
			}
			$.ajax({
				type: 'POST',
				async: false,
				url: wmsContextPath+"dumpWork/printDataFloorT",
				dataType: "json",
				data:JSON.stringify(data),
				contentType : 'application/json',
				success: function(res){
					if(res.code==0){
						var temp = res.data;
						if(temp && temp.length>0){
							var str = "";
							$.each(temp,function(key,value){
								var batchStr = "";
								jquery$("#bcTarget").empty().barcode(key, "code128",{barWidth:2, barHeight:70,showHRI:true});
								var outDiv = $("#outDiv").html();
								str +=  "<div id='printBatchDiv' style='margin:0 auto; padding:15px; width:98%; background: #fff;'>"+
										"<div id='secondDiv' style='height:170px;'>"+
										"<div class='top' style='height:100px;'>"+
										"<div style='float: left;display: block;width: 45%;'>"+
										"<h3 style='font-size:30px; float:right;margin-left: 70px'><strong>转储物料清单</strong></h3>"+
										"</div>"+
										"<div style='float: left;display: block;width: 55%;position:absoulte;'>"+
										outDiv+
										"<span style='float:right;font-size:20px;margin-top: 50px'>载具：</span>"+
										"</div>"+
										"<div style='clear:both'></div>"+
										"</div>"+
										"<div id='bottom' class='bottom' style='margin-top: 12px;margin-bottom: 10px'>";
								for(var i=0;i<value.length;i++){
									//生成二维码
									jquery$("#code").empty().qrcode({
										render: "canvas", //canvas方式
										width: 80, //宽度
										height:80, //高度
										text: "转储单号："+value[i].dumpOrderCode //显示内容
									});
									//二维码canvas转img
									var qrcodeImgSrc = $("canvas")[0].toDataURL('image/jpg');
									batchStr +=
											"<div style='float: left;display: block;width: 60%;line-height:20px;margin-bottom:20px'>"+
											"<p>"+
											"<span style='font-size:18px;'>转储单号：</span><span style='font-size:18px;'>"+value[i].dumpOrderCode+"</span>"+
											"<span style='font-size:18px;margin-left:60px'>转储行项目：</span><span style='font-size:18px;'></span>"+
											"</p>"+
											"<p>"+
											"<span style='font-size:18px;'>目的仓位：</span><span style='font-size:18px'>"+value[i].storageBinId+"</span>"+
											"<span style='font-size:18px;margin-left:60px'>目的仓储类型：</span><span style='font-size:18px'></span>"+
											"</p>"+
											"<p>"+
											"<span style='font-size:18px;'>物料号：</span><span style='font-size:18px'>"+value[i].materialCode+"</span>"+
											"</p>"+
											"<p>"+
											"<span style='font-size:18px;x'>物料描述：</span><span style='font-size:18px'>"+value[i].materialDesc+"</span>"+
											"</p>"+
											"<p>"+
											"<span style='font-size:18px;'>数量/单位：</span><span style='font-size:18px'>"+value[i].accountCount+'/'+value[i].materialUnit+"</span>"+
											"</p>"+
											"<p>"+
											"<span style='font-size:18px;'>源仓位数量/单位：</span><span style='font-size:18px'>"+value[i].accountCount+'/'+value[i].materialUnit+"</span>"+
											"</p>"+
											"<p>"+
											"<span style='font-size:18px;'>检验批号：</span><span style='font-size:18px'>"+value[i].inspectBatchNo+"</span>"+
											"<span style='font-size:18px;margin-left:60px'>序列号：</span><span style='font-size:18px'>"+value[i].serialCode+"</span>"+
											"</p>"+
											"<p>"+
											"<span style='font-size:18px;'>仓库标识：</span><span style='font-size:18px'></span>"+
											"<span style='font-size:18px;margin-left:60px'>工厂：</span><span style='font-size:18px'>"+value[i].factory+"</span>"+
											"<span style='font-size:18px;margin-left:30px'>批次号：</span><span style='font-size:18px'>"+value[i].batchNo+"</span>"+
											"</p>"+
											"<p>"+
											"<span style='font-size:18px;'>制造商：</span><span style='font-size:18px'>"+value[i].manufacturer+"</span>"+
											"</p>"+
											"<p>"+
											"<span style='font-size:18px;'>入库日期：</span><span style='font-size:18px'>"+value[i].passTime+"</span>"+
											"<span style='font-size:18px;margin-left:60px'>保质期：</span><span style='font-size:18px'>"+value[i].expireDate+"</span>"+
											"</p>"+
											"<p>"+
											"<span style='font-size:18px;'>供应商：</span><span style='font-size:18px'>"+value[i].supplierName+"</span>"+
											"</p>"+
											"</div>"+
											"<div style='float: right;display: block;width:100px;height:100px;position:absoulte;margin-right:80px;margin-top:30px'><img src='"+qrcodeImgSrc+"' alt='' width='150' height='150' id='codeImg'></div>"+
											"<div style='clear:both'></div>";
								}
								batchStr +=	"</div>"+
										"</div>"+
										"</div>";

								str = str + batchStr;
								str+="<div style='page-break-after:always;'></div>";
							});
							jquery$("#printContent").empty().append(str).jqprint();
						}else{
							layer.msg("无数据");
							return false;
						}

					}
				}
			});
		}
	};

	function loadding() {
		table.render({
			elem:'#scheduleTab',
			id:'scheduleTabId',
			url:wmsContextPath+'dumpWork/getDumpWorkScheduleListT?arrivalId='+arrivalId,
			cols: [[
				{type:'checkbox',width:40,fixed:'left'},
				{field:'materialCode',title: '物料编号',align:'center',width:150,fixed:'left'},
				{field:'carrierCode',title: '载具编号',align:'center',width:150,fixed:'left'},
				{field:'materialDesc', title: '物料描述',align:'center',width:150},
				{field:'storageBinId', title: '目标仓位',align:'center',width:150},
				{field:'receiptVoucherNo', title: '收货凭证号',align:'center',width:130},
				{field:'sapManager', title: 'SAP管理工',align:'center',width:106},
				{field:'dumpPeople', title: '转储人员',align:'center',width:98},
				{field:'pastePeople', title: '贴单人',align:'center',width:98},
				{field:'dumpOrderCode', title: '转储单号',align:'center',width:204},
				{field:'qualifiedStatus', title: '是否合格',align:'center',width:89},
				{field:'dumpStatus', title: '转储状态',align:'center',width:93},
				{field:'createTime', title: '转储时间',align:'center',width:118},
				{field:'dumpTime', title: '转储时长',align:'center',width:118},
				{field:'overTimeStatus', title: '超时状态',align:'center',width:93},
				{field:'inspectFinishTime', title: '质检完成时间',align:'center',width:93},
				{field:'pasteTime', title: '贴单时间',align:'center',width:93},
				{field:'moveToDumpTime', title: '移库转储区时间',align:'center',width:93},
				{field:'moveToLaneTime', title: '移库巷道口时间',align:'center',width:93},
				{field:'printStaus', title: '打印状态',align:'center',width:93}
			]],
			height: '500px',
			page: {theme: '#008155'},
			even:true,
			done:function(res,page,count){//列表数据回调函数
				//质检类型/转储状态/紧急状态 select
				var dictType = new Array();
				dictType.push("inspect_type");
				dictType.push("dump_status");
				dictType.push("is_urgent");
				var option={
					url:baseContextPath+'dictItems/listDictItemByTypes',
					type:'POST',
					dataType:'json',
					contentType: "application/json",
					data:JSON.stringify(dictType),
					success:function(res){
						if(res.code==0){
							changeItemName(res.data);
							defaultSelect(res.data);
						}
					}
				};
				$.ajax(option);
			}
		});

		function changeItemName(data){
			//table列 是否合格 回显汉字
			$("[data-field='qualifiedStatus']").children().each(function(i,e){
				if(i>0){
					if($(e).text()=='0'){
						$(e).text('不合格');
					}else if($(e).text()=='1'){
						$(e).text('合格');
					}else if($(e).text()=='2'){
						$(e).text('部分合格');
					}
				}
			});
			//table列 转储状态 回显汉字
			$("[data-field='dumpStatus']").children().each(function(i,e){
				for(var i=0;i<data.length;i++){
					if(data[i].dictTypeId=="dump_status" && data[i].itemValue==$(this).text().trim()){
						$(this).text(data[i].itemName);
					}
				}
			});
			//table列 超时状态 回显汉字
			$("[data-field='overTimeStatus']").children().each(function(i,e){
				if(i>0){
					if($(e).text()=='0'){
						$(e).text('否');
					}else if($(e).text()=='1'){
						$(e).text('是').css("color","red");
					}
				}
			});
			//table列 打印状态 回显汉字
			$("[data-field='printStaus']").children().each(function(i,e){
				if(i>0){
					if($(e).text()=='0'){
						$(e).text('未打印');
					}else if($(e).text()=='1'){
						$(e).text('已打印');
					}
				}
			});
			//table列 转储时长 文字替换
			$("[data-field='dumpTime']").children().each(function(i,e){
				if(i>0){
					var isHaveNum = /[0-9]/;
					var flag = isHaveNum.test($(e).text());
					if(!flag){
						$(e).text("--");
					}
				}
			});
		}
		function defaultSelect(dictItems){
			//加载转储状态select
			if(dictItems && dictItems.length>0){
				if($("#dumpStatus").find("option").length==1){
					for(var i=0;i<dictItems.length;i++){
						if(dictItems[i].dictTypeId=="dump_status"){
							$("#dumpStatus").append("<option value="+dictItems[i].itemValue+">"+dictItems[i].itemName+"</option>");
						}
					}
					form.render('select');
				}
			}
			//加载紧急状态select
			if(dictItems && dictItems.length>0){
				if($("#urgentStatus").find("option").length==1){
					for(var i=0;i<dictItems.length;i++){
						if(dictItems[i].dictTypeId=="is_urgent"){
							$("#urgentStatus").append("<option value="+dictItems[i].itemValue+">"+dictItems[i].itemName+"</option>");
						}
					}
					form.render('select');
				}
			}
		}

		$('.layui-btn-container button').on('click', function(){
			var othis = $(this), method = othis.data('method');
			active[method] ? active[method].call(this, othis) : '';
		});

		var laydate = layui.laydate;
		//时间选择器
		laydate.render({
			elem: '#getTime',
			range: true
		});

		initWarehouseMultiSelect("warehouseCode","select1","0",null);
		form.render();

		//生成二维码时对中文进行转码
		function toUtf8(str) {
			var out, i, len, c;
			out = "";
			len = str.length;
			for(i = 0; i < len; i++) {
				c = str.charCodeAt(i);
				if ((c >= 0x0001) && (c <= 0x007F)) {
					out += str.charAt(i);
				} else if (c > 0x07FF) {
					out += String.fromCharCode(0xE0 | ((c >> 12) & 0x0F));
					out += String.fromCharCode(0x80 | ((c >>  6) & 0x3F));
					out += String.fromCharCode(0x80 | ((c >>  0) & 0x3F));
				} else {
					out += String.fromCharCode(0xC0 | ((c >>  6) & 0x1F));
					out += String.fromCharCode(0x80 | ((c >>  0) & 0x3F));
				}
			}
			return out;
		}
	}
</script>
</html>
<div id="outDiv" style="display: none"><div id='bcTarget' style='float:right;'></div></div>
<!--打印内容-->
<div style="display: none"><!-- style="display: none" -->
	<div id="printContent"></div>
</div>
<!-- 二维码 -->
<div id="codeDiv" style="display:none">
	<div id="code" style='float: right;width:140px;height:140px;margin-top:30px;position:absoulte;margin-right: 30px'></div>
</div>
