<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="Content-Type" content="charset=UTF-8">
<meta name="viewport"
	content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="stylesheet" href="/iles/pages/layui/css/layui.css"
	type="text/css" />
<link rel="stylesheet" href="/iles/pages/css/layui_extend.css"
	type="text/css" />
<link rel="stylesheet" href="/iles/pages/layui/css/formSelects-v4.css" />
<title>物料追溯</title>
</head>
<body >
<div id="bodyDiv">

</div>
	<script type="text/html" id="bodyTpl">
    <div class="layui-fluid" >
        <div class="layui-row layui-form">

			<div class="layui-col-md2">
                <label class="layui-form-label">物料号</label>
                <div class="layui-input-inline">
                    <input type="text" id="materialCode_search" class="layui-input" placeholder="请输入物料号">
                </div>
            </div>
			<div class="layui-col-md2">
				<label class="layui-form-label">物料名称</label>
				<div class="layui-input-inline">
					<input type="text" id="materialDesc_search" class="layui-input" placeholder="请输入物料名称">
				</div>
			</div>
			<div class="layui-col-md2">
                <label class="layui-form-label">序列号</label>
                <div class="layui-input-inline">
                    <input type="text" id="serialNum_search" class="layui-input" placeholder="请输入序列号">
                </div>
            </div>

           <div class="layui-btn-container nav-" style="text-align: right;">
					{{# if(d.search==null || d.search=="true"){ }}
             	 		<button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="search" id="search" type="button"><i class="layui-icon layui-icon-search"></i>查询</button>
              			<button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="reset" id="reset" type="button"><i class="layui-icon  layui-icon-reset"></i>重置</button>
              		{{# } }}
			</div>

        </div>

    </div>
    <div class="layui-fluid-table">
		<div class="layui-row layui-form" style="margin-bottom: 0">
			<div class="layui-btn-container" style="text-align: left;">
				{{# if(d.print==null || d.print=="true"){ }}
				<button class="layui-btn layui-btn-normal layui-btn-sm" data-method="print" data-type="auto"
						type="button"><i class="layui-icon  layui-icon-stock-check"></i>序列号打印
				</button>
				{{# } }}
			</div>
		</div>
        <table class="layui-hide" id="materialSerialTab" lay-filter="materialSerialTabF"></table>
    </div>


</script>

</body>


<script src="/iles/pages/layui/layui.all.js" charset="UTF-8"></script>
<script src="/iles/pages/layui/lay/modules/layer.js" charset="UTF-8"></script>

<script src="/iles/pages/js/serverPathConfig.js" charset="UTF-8"></script>
<script src="/iles/pages/js/loginInspect.js" charset="UTF-8"></script>
<script src="/iles/pages/js/common/dictSelelct.js" charset="UTF-8"></script>
<script src="/iles/pages/js/common/warehouseSelect.js" charset="UTF-8"></script>
<script type="text/javascript">
	var element = layui.element;
	var layer = layui.layer;
	var table = layui.table;
	var form = layui.form;
	var laydate = layui.laydate;
	var oldData;
	var contextPath = config.wmsConfig.contextPath;
	var active = {
		print:function (othis){
			var type = othis.data('type');
			layer.open({
				type: 2
				, title: '序列号打印'
				, maxmin: false
				, area: ['450px', '300px']
				, offset: type
				, id: 'printMaterialLabel' + type //防止重复弹出
				, content: 'printMaterialLabel.html'
				, shade: 0 //不显示遮罩
				, yes: function () {
					layer.closeAll();
				}
			});

		},
		search : function(othis) {
			var materialCode = $('#materialCode_search').val();
			var materialDesc = $('#materialDesc_search').val();
			var serialNum = $('#serialNum_search').val();
			var params = {};
			params.materialCode = materialCode;
			params.materialDesc = materialDesc;
			params.serialNum = serialNum;
			//执行重载
			table.reload('materialSerialTabId', {
				where : params,
			});
		},
		reset : function(othis) {
			$('#materialCode_search').val("");
			$('#materialDesc_search').val("");
			$('#serialNum_search').val("");
		}

	};

	function loadding() {
		table.render({
			elem : '#materialSerialTab',
			id : 'materialSerialTabId',
			url : contextPath + 'materialSerial/listMaterialSerial',
			cols : [ [ {
				type : 'checkbox'
			}, {
				field : 'materialCode',
				title : '物料号'
			}, {
				field : 'materialDesc',
				title : '物料名称'
			}, {
				field : 'serialNum',
				title : '序列号'
			},{
				field : 'receivedTaskCode',
				title : '任务号'
			},{
				field : 'taskType',
				title : '任务类型',templet(d){
					if(d.taskType=='1'){
						return '点收';
					}else if(d.taskType=='2'){
						return '拆盘';
					}else if(d.taskType=='3'){
						return '上架';
					}else if(d.taskType=='4'){
						return '下架';
					}else{
						return '-';
					}
				}
			},{
				field : 'carrierCode',
				title : '载具编码'
			},{
				field : 'carrierType',
				title : '载具类型'
			},{
				field : 'invalidStatus',
				title : '作废状态',templet(d){
					if(d.invalidStatus=='0'){
						return '正常';
					}else if(d.invalidStatus=='1'){
						return '作废';
					}else{
						return '-';
					}
				}
			}] ],
			page : {
				theme : '#008155'
			},
			even : true,
			done : function(res, page, count) {//列表数据回调函数
			}
		});
		$('.layui-btn-container button').on('click', function() {
			var othis = $(this), method = othis.data('method');
			active[method] ? active[method].call(this, othis) : '';
		});

	}

</script>

</html>
