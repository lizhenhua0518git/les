<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>新增委外库存</title>
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport"
	content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="stylesheet" href="/iles/pages/layui/css/layui.css"  type="text/css" />
</head>
<body id="bodyDiv">
  
	<script type="text/html" id="bodyTpl">
		<div class="layui-container" style="padding-top: 20px;">
		<form class="layui-form" action="">
			<div class="layui-form-item">
				<div class="layui-inline">
				    <label class="layui-form-label" >库存类型:</label>
				    <div class="layui-input-block">
                     <label class="layui-form-label">委外库存</label> 
                 
				    </div>
			 	</div>
		    </div>
			<div class="layui-form-item">
				<div class="layui-inline">
				    <label class="layui-form-label layui-required">物料编码:</label>
				    <div class="layui-input-block">
				      <input type="text" name="materialCode" id="materialCode" lay-verify="materialCode" autocomplete="off" placeholder="请输入物料编码" readonly="readonly"  class="layui-input" onclick="chooseMaterial()"   >
				    
                 </div>
			 	</div>

               <div class="layui-inline">
				    <label class="layui-form-label layui-required">工厂</label>
				    <div class="layui-input-block">
				      <input type="text" name="factory" id="factory"   autocomplete="off"  readonly="readonly" class="layui-input" >
				    </div>
			 	</div>
		    </div>
		     

             <div class="layui-form-item">
				<div class="layui-inline">
				    <label class="layui-form-label layui-required">库存地点:</label>
				    <div class="layui-input-block">
				      <input type="text" name="storageLocation" id="storageLocation"   lay-verify="storageLocation" autocomplete="off" placeholder="请输入库存地点" readonly="readonly"  class="layui-input" onclick="chooseStorageLocation()">
				    </div>
			 	</div>
             <div class="layui-inline">
				    <label class="layui-form-label layui-required">单位</label>
				    <div class="layui-input-block">
				      <input type="text" name="materialUnit" id="materialUnit"  autocomplete="off" readonly="readonly"  class="layui-input">
				    </div>
			 	</div>
		     </div>

            

            <div class="layui-form-item">
				<div class="layui-inline">
				    <label class="layui-form-label layui-required">委外库存:</label>
				    <div class="layui-input-block">
				      <input type="text" name="stockCount" id="stockCount" lay-verify="stockCount" lay-verify="otherCount" autocomplete="off" placeholder="请输委外库存数量" class="layui-input">
				    </div>
			 	</div>
	       <div class="layui-inline">
				    <label class="layui-form-label layui-required">采购订单号</label>
				    <div class="layui-input-block">
				      <input type="text" name="orderCode" id="orderCode"  lay-verify="orderCode" autocomplete="off" placeholder="请输入订单号" class="layui-input">
				    </div>
			 	</div>
		     </div>

            
            <div class="layui-form-item">
				<div class="layui-inline">
				    <label class="layui-form-label layui-required">供应商:</label>
				    <div class="layui-input-block">
				      <input type="text" name="supplierName" id="supplierName"   lay-verify="supplierName" autocomplete="off" placeholder="请输入供应商" readonly="readonly"  class="layui-input" onclick="chooseSupplier()">
				    </div>
			 	</div>
		     </div>
			   <input type="hidden" value="3"  id="stockType"  name="stockType"/> 
               <input type="hidden" value="3"  id="stockStatus"  name="stockStatus"/> 
               <input type="hidden" name="materialDesc" id="materialDesc"    class="layui-input">
               <input type="hidden" name="warehouseCode" id="warehouseCode"    class="layui-input">
               <input type="hidden" name="warehouseName" id="warehouseName"    class="layui-input">
               <input type="hidden" name="supplierCode" id="supplierCode"    class="layui-input">
               <input type="hidden" name="sapStorageLocation" id="sapStorageLocation"    class="layui-input">
			    <div class="layui-form-item">
	                <div class="layui-btn-container" style="text-align: center;">
	                  <button class="layui-btn layui-btn-normal layui-btn-sm" lay-submit="" lay-filter="areaSubit" id="serve" >保存</button>
	                  <button class="layui-btn layui-btn-normal layui-btn-sm"  lay-submit=""  lay-filter="reset" id="reset">重置</button>
	                </div>
              </div>
		</form>
	</div>
	</script>
	<script src="/iles//pages/layui/layui.all.js" charset="UTF-8"></script>
	<script src="/iles/pages/js/serverPathConfig.js" charset="UTF-8"></script>
    <script src="/iles/pages/js/loginInspect.js" charset="UTF-8"></script>
    <script src="/iles/pages/js/common/dictSelelct.js" charset="UTF-8"></script>
	<script type="text/javascript">
		var layer = layui.layer;
		var table = layui.table;
		var form = layui.form
		var dictItems = parent.dictItems;
		var oldData = parent.oldData;
		var warehouseData = parent.warehouseData;
		var contextPath = config.wmsConfig.contextPath;
		function loadding(){
			 
			form.verify({
				materialCode: function(value){
				      if(value.length < 1){
				        return '物料编码不能为空';
				      }
				      if(value.length>64)
				    	  return '区域编码超长，不能超过64个字符';
				}
				,storageLocation:function(value){
					 if(value.length < 1){
					        return '库存地点不能为空';
					      }
					      if(value.length>64)
					    	  return '库存地点超长，不能超过64个字符';
				},otherCount:function(value){
					 if(value.length < 1){
					        return '委外库存数量不能为空';
					      }
					       
				},supplierName:function(value){
					 if(value.length < 1){
					        return '供应商不能为空';
					      }
					 if(value.length>128)
				    	  return '供应商超长，不能超过128个字符';
					      
				},orderCode:function(value){
					 if(value.length < 1){
					        return '采购订单号不能为空';
					      }
					      if(value.length>64)
					    	  return '采购订单号超长，不能超过64个字符';
				}
				
			  });
			  //监听提交
			  form.on('submit(areaSubit)', function(data){
				saveDict(data);
				return false;
			   });
			  queryDictItem('area_type','areaType','');
		};
		
		
		function saveDict(data){
			var option = {
		    	url:contextPath+'materialInstock/saveOtherInventory',
		    	data:JSON.stringify(data.field),
		    	type:'POST',
		    	contentType:'application/json',
		    	success:function(data){
		    		if(data.code==0){
		    			var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
		    			parent.layer.close(index);  // 关闭layer
		    			parent.parentId = "";
		    			parent.table.reload('areaTabId');
		    		}else{
		    			layer.alert(data.data);
		    		}
		    	},error:function(data){
		    		layer.alert(data.msg);
		    	}
		    }
		    $.ajax(option); 
		}
		
		// 选择库存地点
		function chooseStorageLocation(){
			layer.open({
		        type: 2
		        ,title:'选择库存地点'
		        ,maxmin:true
		        ,area: ['400px', '400px']
		        ,id: 'chooseStorageLocation' //防止重复弹出
		        ,content: '/iles/pages/wms/inventory/chooseStorageLocation.html'
		        ,shade: 0 //不显示遮罩
		        ,yes: function(){
		          layer.closeAll();
		        }
		   });
		}
		
		// 选择物料
		function chooseMaterial(){
			layer.open({
		        type: 2
		        ,title:'选择物料'
		        ,maxmin:true
		        ,area: ['400px', '400px']
		        ,id: 'chooseMaterial' //防止重复弹出
		        ,content: '/iles/pages/wms/inventory/chooseMaterial.html'
		        ,shade: 0 //不显示遮罩
		        ,yes: function(){
		          layer.closeAll();
		        }
		   });
		}
		
		// 选择供货商
		function chooseSupplier(){
			layer.open({
		        type: 2
		        ,title:'选择供货商'
		        ,maxmin:true
		        ,area: ['400px', '400px']
		        ,id: 'chooseMaterial' //防止重复弹出
		        ,content: '/iles/pages/wms/inventory/chooseSupplier.html'
		        ,shade: 0 //不显示遮罩
		        ,yes: function(){
		          layer.closeAll();
		        }
		   });
		}
	</script>
</body>
</html>