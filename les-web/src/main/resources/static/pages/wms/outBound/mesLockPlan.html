<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="Content-Type" content="charset=UTF-8">
<meta name="viewport"
    content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<title>锁定计划</title>
<link rel="stylesheet" href="/iles/pages/layui/css/layui.css"  type="text/css" />
<link rel="stylesheet" type="text/css" href="/iles/pages/css/layui_extend.css"/>
<link rel="stylesheet" href="/iles/pages/layui/css/formSelects-v4.css" />
</head>
<body id="bodyDiv">
<script type="text/html" id="bodyTpl">
<div class="layui-fluid">
	<div class="layui-row layui-form">
		<div class="layui-col-md2">
			<label class="layui-form-label">生产时间</label>
			<div class="layui-input-block">
				<input type="text" id="onlineTime" class="layui-input" placeholder="请输入生产时间">
			</div>
		</div>
		<div class="layui-col-md2">
			<label class="layui-form-label">生产订单</label>
			<div class="layui-input-block">
				<input type="text" id="orderCode" class="layui-input" placeholder="请输入生产订单">
			</div>
		</div>
		<div class="layui-col-md2">
			<label class="layui-form-label">车间</label>
			<div class="layui-input-block">
				<select  id="shopCode"  xm-select="shopCodeSelect" xm-select-show-count="1">
					<option value="">请选择</option>
				</select>
			</div>
		</div>
		<div class="layui-col-md2">
			<label class="layui-form-label">产线</label>
			<div class="layui-input-block">
				<select  id="lineCode" xm-select="lineCodeSelect" xm-select-show-count="1">
					<option value="">请选择</option>
				</select>
			</div>
		</div>
		<div class="layui-btn-container nav-" style="text-align: right;">
			{{# if(d.search==null || d.search=="true"){ }}
				<button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="search" id="search" type="button"><i class="layui-icon layui-icon-search"></i>查询</button>
				<button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="reset"  id="reset" type="button"><i class="layui-icon layui-icon-reset"></i>重置</button>
<!--					<button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="orderSplit"  id="orderSplit" type="button"><i class="layui-icon layui-icon-reset"></i>订单分批</button>-->
			{{# } }}
		</div>
	</div>
</div>
<div class="layui-fluid-table">
<table class="layui-hide" id="mesLockPlanTab" lay-filter="mesLockPlanTabF"></table>
</div>
</script>
<script src="/iles/pages/layui/layui.all.js" charset="UTF-8"></script>
<script src="/iles/pages/js/serverPathConfig.js" charset="UTF-8"></script>
<script src="/iles/pages/js/loginInspect.js" charset="UTF-8"></script>
<script src="/iles/pages/js/common/dictSelelct.js" charset="UTF-8"></script>
<script type="text/javascript">
var table = layui.table;
var laydate = layui.laydate;
var contextPath = config.wmsConfig.contextPath;
var omstextPath = config.omsConfig.contextPath;
var active = {
		search:function(othis){
			var onlineTime = $("#onlineTime").val();
			var orderCode = $("#orderCode").val();
			var shopCode = layui.formSelects.value('shopCodeSelect', 'valueStr');
			var lineCode = layui.formSelects.value('lineCodeSelect', 'valueStr');
			var onlineStartTime='';
			var onlineEndTime='';
			if(onlineTime.length>0){
				onlineStartTime = onlineTime.substring(0,10);
				onlineEndTime = onlineTime.substring(13);
			}
			table.reload('mesLockPlanTabId',{
				where:{
					onlineStartTime:onlineStartTime,
					onlineEndTime:onlineEndTime,
					shopCode:shopCode,
					lineCode:lineCode,
					orderCode:orderCode
				}
				,page:{"curr":1}
			});
		},
		reset:function(othis){
			$("#onlineTime").val("");
			$("#orderCode").val("");
			layui.formSelects.value('shopCodeSelect', []);
			layui.formSelects.value('lineCodeSelect', []);
		},
		orderSplit:function(othis) {
			$.ajax({
				url: omstextPath +'processOrder/orderSplit',
				dataType: 'json',
				success: function (data) {
					alert(data.msg);
				}
			});
		}
};
function loadding(){
	table.render({
		elem:'#mesLockPlanTab',
		id:'mesLockPlanTabId',
		url: contextPath +'mesLockPlan/listMesLockPlan',
		cols:[[
		{type:'checkbox'},
		{type:'numbers',title:'序号',width: 60},
		{field:'orderCode',title:'订单号'},
		{field:'onlineSeqnumber',title:'上线顺序'},
		{field:'vinCode',title:'VIN号'},
		{field:'onlineTime',title:'生产时间'},
		{field:'factoryName',title:'工厂'},
		{field:'workShopName',title:'车间'},
		{field:'lineName',title:'产线'},
		]],
		page: {theme: '#008155'},
   		even:true
	});
	$('.layui-btn-container button').on('click', function(){
	    var othis = $(this), method = othis.data('method');
	    active[method] ? active[method].call(this, othis) : '';
  	});
	//创建时间区间
 	laydate.render({
	    elem: '#onlineTime',
	    range: true
	});
 	inintPlantMultiSelect("shopCodeSelect",[],2);
 	inintPlantMultiSelect("lineCodeSelect",[],3);
}
</script>
</body>

</html>
