<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="Content-Type" content="charset=UTF-8">
<meta name="viewport"
	content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="stylesheet" href="/iles/pages/layui/css/layui.css"  type="text/css" />
<link rel="stylesheet" href="/iles/pages/css/layui_extend.css"  media="all">
<link rel="stylesheet" href="/iles/pages/layui/css/modules/layer/default/layer.css"  type="text/css" />
<title></title>
</head>
<style type="text/css">
.layui-table-body{
	overflow-x:scroll;
}
</style>
<body>
  <div id="bodyDiv">

</div>

	<script src="/iles/pages/layui/layui.all.js" charset="UTF-8"></script>
	<script src="/iles/pages/js/serverPathConfig.js" charset="UTF-8"></script>
	<script src="/iles/pages/layui/lay/modules/tableFilter.js" charset="UTF-8"></script>
	<script src="/iles/pages/assets/js/jquery-1.10.2.js"></script>
	<script src="/iles/pages/js/loginInspect.js"></script>

<script type="text/html" id="bodyTpl">
    <div class="layui-fluid">
	<div class="layui-row layui-form">
			<div class="layui-col-md3">
			 	<label class="layui-form-label">物料编号:</label>
			 	 <div class="layui-input-block">
			      <input type="text" id="materialCode" placeholder="请输入物料编号" class="layui-input">
			    </div>
			 </div>
			 <div class="layui-col-md3">
			 	<label class="layui-form-label">物料描述:</label>
			 	 <div class="layui-input-block">
			      <input type="text" id="materialDesc" placeholder="请输入物料描述" class="layui-input">
			    </div>
			 </div>
			 <div class="layui-col-md3">
				<label class="layui-form-label">生产订单:</label>
			 	<div class="layui-input-block">
			       <input type="text" id="orderCode" placeholder="请输入生产订单" class="layui-input">
			    </div>
			</div>
			<div class="layui-col-md3">
				<label class="layui-form-label">需求日期:</label>
			 	<div class="layui-input-block">
			       <input type="text" id="requiredDate" placeholder="请输入生产订单" class="layui-input">
			    </div>
			</div>
	</div>

		<div class="layui-row layui-form" style="margin-bottom: 0">
			<div class="layui-col-md3">
				<label class="layui-form-label">工位:</label>
			 	 <div class="layui-input-block">
			       <input type="text" id="stationCode" placeholder="请输入工位" class="layui-input">
			    </div>
			</div>
			<div class="layui-col-md3">
				<label class="layui-form-label">物料状态:</label>
			 	 <div class="layui-input-block">
			       <select  id="materialStatus" lay-filter="factory">
			        <option value="">请选择</option>
			        <option value="jp">拣配中</option>
			        <option value="ps">配送中</option>
			        <option value="wk">未作业</option>
			        <option value="sh">收货中</option>
			        <option value="zj">质检中</option>
			      </select>
			    </div>
			</div>
			<div class="layui-col-md6">
				<div class="layui-btn-container" style="text-align: right;">
					<button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="search" id="search" type="button"><i class="layui-icon layui-icon-search"></i>查询</button>
  					<button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="reset" type="button"><i class="layui-icon-reset"></i>重置</button>
				</div>
			</div>
		</div>
	</div>
	<table class="layui-hide" id="urgentMaterialSecond" lay-filter="urgentMaterialSecondF"></table>
     </script>
	<script type="text/html" id="ContrlBar">
	<a class="layui-btn layui-btn-xs" lay-event="info">详情</a>
</script>
	<script type="text/javascript">
	var contextPath = config.wmsConfig.contextPath;
	var $ = layui.$;
	var element = layui.element;
	var layer = layui.layer;
	var table = layui.table;
	var form = layui.form;
	var oldData;
	var dictItems = null;//数据字典

function loadding(){

	layui.use('laydate', function(){
		var laydate = layui.laydate;
		//时间选择器
		  laydate.render({
		    elem: '#requiredDate'
		    ,type: 'datetime'
		    ,range: true
		  });
	});
	table.render({
		elem:'#urgentMaterialSecond',
		id:'urgentMaterialSecondId',
		url:contextPath+'urgentMaterialClassify/listUrgentMaterialSecond',
		cols:[[
		{type:'checkbox'},
		{field:'materialCode',width:100,title:'物料编号'},
		{field:'materialDesc',width:150, title: '物料描述'},
		{field:'subFactory',width:100, title: '分厂'},
		//{field:'materialType',width:100, title: '物料类别'},
		{field:'pipleLine',width:100, title: '产线'},
		{field:'orderCode',width:120, title: '生产订单号'},
		{field:'stationCode', width:120,title: '工位'},
		{field:'factory',width:120, title: '工厂'},
		{field:'requireDate',width:100, title: '需求日期'},
		{field:'requiredTime',width:100, title: '需求时间'},
		{field:'warehouseName',width:100, title: '库存地点'},
		{field:'bdmng',width:100, title: '需求数量'},
		{field:'sendCount',width:100, title: '送达数量'},
		{field:'assembleCount',width:120, title: '集料未送'},
		{field:'pickCount',width:120, title: '拣配中'},
		{field:'waitCount',width:90, title: '待派工'},
		{field:'waitMatchCount',width:90, title: '待匹配'},
		{field:'noToCount',width:120, title: '未创建TO'},
		{fixed:'right',align:'center',toolbar:'#ContrlBar',title:'操作'}
		]],
		page: {theme: '#008155'},
   		height: 'full-95',
   		even:true
	});
	var active = {


			search:function(othis){
				var materialCode=$('#materialCode').val();
				var materialDesc=$('#materialDesc').val();
				var orderCode=$('#orderCode').val();
				var requiredDate=$('#requiredDate').val();
				var stationCode=$('#stationCode').val();
				var materialStatus=$('#materialStatus').val();
				var requiredStart = "";
				var requiredEnd = "";
				if(requiredDate!=null && requiredDate.length>0){
					requiredStart = requiredDate.substring(0,20);
					requiredEnd = requiredDate.substring(22);
				}
				var params={};
				params.materialCode=materialCode;
				params.materialDesc=materialDesc;
				params.orderCode=orderCode;
				params.requiredStart=requiredStart;
				params.requiredEnd=requiredEnd;
				params.stationCode=stationCode;
				params.materialStatus=materialStatus;
			      //执行重载
			      table.reload('urgentMaterialSecondId', {
			        where:params,
			        page:{"curr":1}
			      });
			},reset:function(othis){
				$('#materialCode').val('');
				$('#materialDesc').val('');
				$('#factory').val('');
				$('#status').val('');
				$('#orderCode').val('');
				$('#stationCode').val('');
				$('#requiredDate').val('');
				form.render("select");
			}

	};
	$('.layui-btn-container button').on('click', function(){
	    var othis = $(this), method = othis.data('method');
	    active[method] ? active[method].call(this, othis) : '';
  	});
	table.on('tool(urgentMaterialSecondF)', function(obj){
		 var value = obj.value
		    ,data = obj.data;
		 oldData = data;
		 layer.open({
	        type: 2
	        ,title:'紧急物料详情'
	        ,maxmin:true
	        ,area: ['100%', '100%']
	        ,id: 'materialThreeId' //防止重复弹出
	        ,content: 'urgentSecondDetail.html'
	        ,shade: 0 //不显示遮罩
	        ,yes: function(){
	          layer.closeAll();
	        }
	     });
	});
	}

</script>
</body>
</html>
