<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="Content-Type" content="charset=UTF-8">
<meta name="viewport"
	content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="stylesheet" href="/iles/pages/layui/css/layui.css"  type="text/css" />
<link rel="stylesheet" href="/iles/pages/css/layui_extend.css"  media="all">
<link rel="stylesheet" href="/iles/pages/layui/css/modules/layer/default/layer.css"  type="text/css" />
<title></title>
<style type="text/css">

.layui-timeline-item:before {
        content: '';
	    position: absolute;
	    left: 5px;
	    top: 10px;
	    z-index: 0;
	    width: 100%;
	    height: 1px;
}
.layui-timeline-content {
    padding-top: 24px;
    padding-left: 0px;
}
.layui-timeline-item:before, hr {
    background-color: #33b648;
}
.layui-form-label {
    float: left;
    display: block;
    padding: 9px 15px;
    font-weight: 400;
    width: auto;
    line-height: 20px;
    text-align: right;
}
</style>
</head>

<body>
<div id="bodyDiv"></div>
<div id="materialInfo"></div>
<div id="materialprocess" style="padding-top:100px;"></div>
<div id="materialLocal" style="padding-top:100px;"></div>
<script src="/iles/pages/layui/layui.all.js" charset="UTF-8"></script>
	<script src="/iles/pages/js/serverPathConfig.js" charset="UTF-8"></script>
	<script src="/iles/pages/layui/lay/modules/tableFilter.js" charset="UTF-8"></script>
	<script src="/iles/pages/assets/js/jquery-1.10.2.js"></script>
	<script src="/iles/pages/js/loginInspect.js"></script>
	<script type="text/html" id="bodyTpl"></script>
<script type="text/html" id="materialLocalTpl">
<div class="layui-fluid">
	<div class="layui-row layui-form">
		<div class="layui-col-md2">
			 	<label class="layui-form-label">未创建凭证</label>
		</div>
		<div class="layui-col-md2">
			 	<label class="layui-form-label">质检中</label>
		</div>
		<div class="layui-col-md2">
			 	<label class="layui-form-label">点收中</label>
		</div>
		<div class="layui-col-md2">
			 	<label class="layui-form-label">等待点收</label>
		</div>
		<div class="layui-col-md2">
			 	<label class="layui-form-label">卸货中</label>
		</div>
		<div class="layui-col-md2">
			 	<label class="layui-form-label">等待卸货</label>
		</div>
	</div>
	<div class="layui-row layui-form">
		<div class="layui-col-md2">
			 	<label class="layui-form-label"></label>
		</div>
		<div class="layui-col-md2">
			 	<label class="layui-form-label">{{ d.inspectNum }}{{ d.materialUnit }}</label>
		</div>
		<div class="layui-col-md2">
			 	<label class="layui-form-label">{{ d.pointNum }}{{ d.materialUnit }}</label>
		</div>
		<div class="layui-col-md2">
			 	<label class="layui-form-label">{{ d.waitPointNum }}{{ d.materialUnit }}</label>
		</div>
		<div class="layui-col-md2">
			 	<label class="layui-form-label">{{ d.uploadNum }}{{ d.materialUnit }}</label>
		</div>
		<div class="layui-col-md2">
			 	<label class="layui-form-label">{{ d.waitUploadNum }}{{ d.materialUnit }}</label>
		</div>
	</div>
</div>
</script>
<script type="text/html" id="materialprocessTpl">
{{#  layui.each(d, function(index, item){ }}
<div class="layui-fluid">
	<div class="layui-row layui-form">
		<div class="layui-col-md1">
			<label class="layui-form-label">{{ item.materialStatus }}</label>
		</div>
		<div class="layui-col-md11">
			<ul class="layui-timeline">
			  <li class="layui-timeline-item"  style="display:inline-block;">
			    <i class="layui-icon layui-timeline-axis">
					{{#  if(item.jobNode > 0){ }}
						&#x1005;
					{{# } }}
				</i>
			    <div class="layui-timeline-content layui-text" style="width:200px;">
			      <div class="layui-timeline-title">创建凭证</div>
			    </div>
			  </li>
			  <li class="layui-timeline-item" style="display:inline-block;">
			    <i class="layui-icon layui-timeline-axis">
					{{#  if(item.jobNode > 1){ }}
						&#x1005;
					{{# } }}
				 </i>
			    <div class="layui-timeline-content layui-text" style="width:200px;">
			      <div class="layui-timeline-title">创建TO</div>
			    </div>
			  </li>
			  <li class="layui-timeline-item" style="display:inline-block;">
			    <i class="layui-icon layui-timeline-axis">
				<i class="layui-icon layui-timeline-axis">
					{{#  if(item.jobNode >= 30){ }}
						&#x1005;
					{{# } }}
				 </i>
				</i>
			    <div class="layui-timeline-content layui-text" style="width:200px;">
			      <div class="layui-timeline-title">匹配任务</div>
			    </div>
			  </li>
			  <li class="layui-timeline-item" style="display:inline-block;">
			    <i class="layui-icon layui-timeline-axis">
					{{#  if(item.jobNode >= 31){ }}
						&#x1005;
					{{# } }}
				</i>
			    <div class="layui-timeline-content layui-text" style="width:200px;">
			      <div class="layui-timeline-title">完成派工</div>
			    </div>
			  </li>
			  <li class="layui-timeline-item" style="display:inline-block;">
			    <i class="layui-icon layui-timeline-axis">
					{{#  if(item.jobNode >= 33){ }}
						&#x1005;
					{{# } }}
				</i>
			    <div class="layui-timeline-content layui-text" style="width:200px;">
			      <div class="layui-timeline-title">下架完成</div>
			    </div>
			  </li>
			  <li class="layui-timeline-item" style="display:inline-block;">
			    <i class="layui-icon layui-timeline-axis">
					{{#  if(item.jobNode >= 35){ }}
						&#x1005;
					{{# } }}
				</i>
			    <div class="layui-timeline-content layui-text" style="width:200px;">
			      <div class="layui-timeline-title">集配完成</div>
			    </div>
			  </li>
			  <li class="layui-timeline-item" style="display:inline-block;">
			    <i class="layui-icon  layui-timeline-axis">
					{{#  if(item.jobNode >= 70){ }}
						&#x1005;
					{{# } }}
				</i>
			    <div class="layui-timeline-content layui-text" style="width:200px;">
			      <div class="layui-timeline-title">送达完成</div>
			    </div>
			  </li>
			</ul>
		</div>	
	</div>
</div>
{{#  } }}
</script>
<script type="text/html" id="materialTpl">
<div class="layui-fluid">
	<div class="layui-row layui-form">
		<div class="layui-col-md3">
			 	<label class="layui-form-label">物料编号</label>
		</div>
		<div class="layui-col-md3">
			 	<label class="layui-form-label">物料描述</label>
		</div>
		<div class="layui-col-md3">
			 	<label class="layui-form-label">生成订单</label>
		</div>
		<div class="layui-col-md3">
			 	<label class="layui-form-label">遗留数量</label>
		</div>
	</div>
	<div class="layui-row layui-form">
		<div class="layui-col-md3">
			 	<label class="layui-form-label">{{ d.materialCode }}</label>
		</div>
		<div class="layui-col-md3">
			 	<label class="layui-form-label">{{ d.materialDesc }}</label>
		</div>
		<div class="layui-col-md3">
			 	<label class="layui-form-label">{{ d.orderCode }}</label>
		</div>
		<div class="layui-col-md3">
			 	<label class="layui-form-label">{{ d.bdmng }}</label>
		</div>
	</div>
</div>
</script>
<script type="text/javascript">
function loadding(){}
var contextPath = config.wmsConfig.contextPath;
	var oldData = parent.oldData;
	var $ = layui.$;
	var layer = layui.layer;
	var laytpl = layui.laytpl;
	var getTpl = materialTpl.innerHTML
	,view = document.getElementById('materialInfo');
	laytpl(getTpl).render(oldData, function(html){
	  view.innerHTML = html;
	});
	
	if(oldData.noToCount>0){//查询收货中的任务
		var option = {
				url:contextPath+'urgentMaterialClassify/listRecieveStatus?sapDetailId='+oldData.spodId,
				type:'GET',
				success:function(res){
					if(res.code==0){
						var data = res.data;
						var getTpl = materialLocalTpl.innerHTML
						,view = document.getElementById('materialLocal');
						laytpl(getTpl).render(data, function(html){
						  view.innerHTML = html;
						});
					}
				}
			};	
			$.ajax(option);
	}
	//查询发货中的任务
	if(oldData.assembleCount>0 || oldData.sendCount>0 || oldData.pickCount>0 ||oldData.waitMatchCount ||  oldData.waitCount>0){
		var option = {
				url:contextPath+'urgentMaterialClassify/listSendStatus?sapDetailId='+oldData.spodId,
				type:'GET',
				success:function(res){
					if(res.code==0){
						var data = res.data;
						var getTpl = materialprocessTpl.innerHTML
						,view = document.getElementById('materialprocess');
						laytpl(getTpl).render(data, function(html){
						  view.innerHTML = html;
						});
					}
				}
			};	
			$.ajax(option);
	}
</script>
</body>
</html>