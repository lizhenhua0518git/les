<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>仓位</title>
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport"
	content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="stylesheet" href="/iles/pages/layui/css/layui.css"  type="text/css" />
<link rel="stylesheet" href="/iles/pages/css/layui_extend.css"  media="all">
<style type="text/css">
.layui-table-body{
	overflow:hidden;
}
</style>
</head>
<body>
<div id="bodyDiv">

</div>
	<div class="layui-fluid">
		<div class="layui-row layui-form">
			<div class="layui-col-md3">
			 	<label class="layui-form-label">仓位编号:</label>
			 	 <div class="layui-input-block">
			      <input type="text" id="positionCode_search" class="layui-input">
			    </div>
			</div>

		</div>
		<div class="layui-row layui-form" style="margin-bottom: 0">
			<div class="layui-col-md6">&nbsp;</div>
			<div class="layui-col-md6">
				<div class="layui-btn-container" style="text-align: right;">
					  <button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="search"><i class="layui-icon">&#xe615;</i>查询</button>
					  <button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="reset"><i class="mine-icon">&#xe640;</i>重置</button>
					  <button class="layui-btn layui-btn-normal layui-btn-sm" data-method="save" type="button"><i class="mine-icon icon-add"></i>保存</button>
				</div>
			</div>
		</div>
	</div>
	<table id="storeBinTab" lay-filter="storeBinTabF"></table>
	<script src="/iles/pages/layui/layui.all.js" charset="UTF-8"></script>
	<script src="/iles/pages/js/serverPathConfig.js" charset="UTF-8"></script>
    <script src="/iles/pages/js/loginInspect.js" charset="UTF-8"></script>
	<script type="text/html" id="bodyTpl"></script>
	<script type="text/javascript">
		var $ = layui.$;
		var element = layui.element;
		var layer = layui.layer;
		var table = layui.table;
		var form = layui.form;
		var contextPath = config.wmsConfig.contextPath;
        var stationCode =  parent.$("#stationCode").val();
        var transferOutBin=parent.$("#positionCode").val();
        var materialStorageBinId=parent.$("#storageBinId").val();
        var transNum=parent.$("#transNum").val();
        var materialCode=parent.$("#materialCodeValue").val();
		table.render({
			elem:'#storeBinTab',
			id:'storeBinTabId',
			url:contextPath+'storeTransfer/queryPositionCodeNew',
			where:{materialCode:materialCode,transferOutBin:transferOutBin},
			cols:[[
			{type:'radio'}
			,{field:'positionCode',title:'仓位编号'}
			]],
			page: {theme: '#008155'},
    		even:true
		});
		var active = {
				search:function(othis){
					var positionCode = $('#positionCode_search');
					//var positionName =  $('#positionName_search');
				      //执行重载
				      table.reload('storeBinTabId', {
				        where:{
				        	positionCode: positionCode.val()
				        	,materialCode:materialCode
				        	,transferOutBin:transferOutBin
				        }
				     	 ,page:{"curr":1}
				      });
				      $("input[lay-filter=layTableAllChoose]").parent().hide();
				},reset:function(othis){
					$('#positionCode_search').val("");
				},save:function(othis){
					var checkStatus = table.checkStatus('storeBinTabId');
					var tableObj = checkStatus.data;
					if(tableObj.length==0){
						layer.alert('请选择仓位！',{icon: 2});
		                return;
					}
					//alert(materialStorageBinId+'---'+transNum+'---'+tableObj[0].ID+'---'+tableObj[0].POSITION_CODE);
					var params={};
					params.materialStorageBinId=materialStorageBinId;
					params.transNum=transNum;
					params.positionCodeOut=transferOutBin;
					params.positionCodeIn=tableObj[0].positionCode;
					parent.tableData.push(params);
					parent.layer.closeAll();
					parent.xianshi();
					/* var option = {
		                url:'${ctx}/storeTransfer/saveTransMainAndDetail',
		                data:params,
		                //type:'POST',
		                //contentType:'application/json',
		                success:function(res){
		                    if(res.code==0){
		                    	//layer.alert('保存成功！',{icon: 2});
		                    	parent.parent.layer.closeAll();
		    					parent.parent.table.reload('storeTransferTabId');
		                    }else{
		                    	layer.alert(res.data,{icon: 2});
		                    }
		                },error:function(res){
		                    layer.alert(res.msg);
		                    parent.parent.layer.closeAll();
	    					parent.parent.table.reload('storeTransferTabId');
		                }
		            }
		            $.ajax(option);  */

				}
		//active
		};
		$('.layui-btn-container button').on('click', function(){
		    var othis = $(this), method = othis.data('method');
		    active[method] ? active[method].call(this, othis) : '';
	  	});

		//隐藏全选的复选框
		// $("input[lay-filter=layTableAllChoose]").parent().hide();

		/* table.on('radio(storeBinTabF)',function(res){
			//var tableObj = table.cache.storeBinTabId;
			  var checkStatus = table.checkStatus('storeBinTabId');
			  var tableObj = checkStatus.data;
			  if(tableObj.length >1){
				layer.alert('只能选择一行！',{icon: 2});
                return false;
			 }

			if(tableObj.length==1){
				parent.$("#transferInBin").val(tableObj[0].POSITION_CODE);
        		return false;
			}
        	if(res.checked){
        		parent.$("#transferInBin").val(res.data.POSITION_CODE);
        	}

	    }); */
	</script>
</body>
</html>
