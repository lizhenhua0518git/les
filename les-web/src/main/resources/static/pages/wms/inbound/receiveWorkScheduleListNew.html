<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="renderer" content="webkit|ie-comp|ie-stand">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta http-equiv="Content-Type" content="charset=UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<meta http-equiv="Cache-Control" content="no-siteapp" />
	<link rel="stylesheet" href="/iles/pages/layui/css/layui.css"  type="text/css" />
	<link rel="stylesheet" href="/iles/pages/css/layui_extend.css"  media="all">
	<link rel="stylesheet" href="/iles/pages/layui/css/modules/layer/default/layer.css"  type="text/css" />
	<link rel="stylesheet" href="/iles/pages/layui/css/formSelects-v4.css" />
	<style>
		.layui-table-view{margin-bottom:0;}
		.layui-layer-content-new{background: linear-gradient(#001a47,#022558);}
	</style>
	<title>点收作业调度</title>
</head>
<div id="bodyDiv">

</div>
    <!--打印-->
<script src="/iles/pages/lib/jquery-qrcode-0.14.0/jquery.min.js"></script>
<script src="/iles/pages/lib/jquery-qrcode-0.14.0/jquery-qrcode-0.14.0.min.js"></script>
<script src="/iles/pages/lib/jquery-barcode/jquery-migrate-1.2.1.min.js"></script>
<script src="/iles/pages/lib/jquery-barcode/jquery.jqprint-0.3.js"></script>
<script type="text/javascript">var jquery$ = $;</script>
<script src="/iles/pages/lib/jquery-barcode/jquery-barcode.js"></script>

<script src="/iles/pages/layui/layui.all.js" charset="UTF-8"></script>
<script src="/iles/pages/js/loginInspect.js" charset="UTF-8"></script>
<script src="/iles/pages/js/serverPathConfig.js" charset="UTF-8"></script>
<script src="/iles/pages/js/common/warehouseSelect.js" charset="UTF-8"></script>


<script type="text/html" id="bodyTpl">
	<input type="hidden" id="totalNum"/>
	<input type="hidden" id="someArrivalValue"/>
	<input type="hidden" id="receiveId"/>
	<input type="hidden" id="arrivalId"/>
	<div class="layui-fluid">
		<div class="layui-row layui-form">
			<div class="layui-col-md3">
				<label class="layui-form-label">到货通知单:</label>
				<div class="layui-input-block">
					<input type="text" name="arrivalCode" id="arrivalCode" class="layui-input" placeholder="请输入到货通知单">
				</div>
			</div>
			<div class="layui-col-md3">
				<label class="layui-form-label">仓库编号:</label>
				<div class="layui-input-block">
					<select id="warehouseCode" xm-select="select1" xm-select-show-count="1">
						<option value="">请选择</option>
					</select>
				</div>
			</div>
			<div class="layui-col-md3">
				<label class="layui-form-label">点收日期:</label>
				<div class="layui-input-block layui-form">
					<input type="text" class="layui-input" name="getTime" id="getTime" placeholder="请选择点收日期">
				</div>
			</div>
			<div class="layui-col-md3">
				<label class="layui-form-label">状态:</label>
				<div class="layui-input-block layui-form">
					<select id="jobNode" name="jobNode">
						<option value=""></option>
					</select>
				</div>
			</div>
		</div>
		<div class="layui-row layui-form">
			<div class="layui-col-md3">
				<label class="layui-form-label">点收团队:</label>
				<div class="layui-input-block layui-form">
					<select id="teamId" name="teamId">
						<option value=""></option>
					</select>
				</div>
			</div>
			<div class="layui-col-md3">
				<label class="layui-form-label">点收审核人:</label>
				<div class="layui-input-block layui-form">
					<select id="checkUid" name="checkUid">
						<option value=""></option>
					</select>
				</div>
			</div>
			<div class="layui-col-md3">
				<label class="layui-form-label">物料号:</label>
				<div class="layui-input-block">
					<input type="text" name="materialCode" id="materialCode" class="layui-input" placeholder="请输入物料号">
				</div>
			</div>
			<div class="layui-col-md3">
				<label class="layui-form-label">紧急状态:</label>
				<div class="layui-input-block">
					<select id="isUrgent" name="isUrgent">
						<option value=""></option>
					</select>
				</div>
			</div>
			<!-- 按钮区域begin -->
			<div class="layui-col-md3">
				&nbsp;
			</div>
		</div>
		<div class="layui-row layui-form">
			<div class="layui-col-md6">
				<div class="layui-btn-container" style="text-align: left;">
					<#if athemTag.search?? && athemTag.search=="true">
					<button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="search" type="button"><i class="layui-icon layui-icon-search"></i>查询</button>
					<button class="layui-btn layui-btn-normal layui-btn-sm"  data-method="reset" type="button"><i class="layui-icon-reset"></i>重置</button>
					</#if>
					<#if athemTag.print?? && athemTag.print=="true">
					<button class="layui-btn layui-btn-normal layui-btn-sm" onclick="printDataFloor();" data-method="print" type="button"><i class="mine-icon icon-print"></i>地堆打印</button>
					<button class="layui-btn layui-btn-normal layui-btn-sm" onclick="printDataShelf();" data-method="print" type="button"><i class="mine-icon icon-print"></i>货架打印</button>
					</#if>
				</div>
			</div>
			<div class="layui-col-md6">
				<i class="layui-icon layui-icon-help" style="font-size: 24px;color: #bdbd19;float:none;padding-top: 13px;" onclick="helpDoc()"></i>&nbsp;
			</div>
			<input type="hidden" id="carrierCode" value="">
		</div>
	</div>
	<table id="scheduleTab" lay-filter="scheduleTabF"></table>
</script>

<script type="text/javascript">
	var laytpl = layui.laytpl;
	function printDataShelf(){	//打印
		var checkStatus = table.checkStatus('scheduleTabId');
		var data = checkStatus.data;
		if(data.length==0){
			layer.alert('未选中行',{icon: 2});
			return false;
		}
		$.ajax({
			type: 'POST',
			async: false,
			url: wmsContextPath+"receiveWork/printShelfData",
			dataType: "json",
			data:JSON.stringify(data),
			contentType : 'application/json',
			success: function(result){
				if(result.code==0){
					$("#printContent").show();
					var data = result.data;
					if(data && data.length>0){
						var getTpl = stockPrint.innerHTML
						,view = document.getElementById('printContent');
						laytpl(getTpl).render(data, function(html){
							view.innerHTML = html;
						});
						var text="";
						for(var i=0;i<data.length;i++){
							text = data[i].voucherNo;
							jquery$("#canvas_"+i).qrcode({
								render : 'canvas',    //设置渲染方式，有table和canvas，使用canvas方式渲染性能相对来说比较好
								text : text, //扫描二维码后显示的内容,\n换行
								size : 120
							});
							var img = document.getElementById("image_"+i); // get image element
							var canvas  = document.getElementById("canvas_"+i);  // get canvas element
							img.src = canvas.toDataURL();//"image/png"
						}
					}else{
						layer.msg("无数据");
						return false;
					}
				}
				jquery$("#printContent").jqprint({importCSS:true});
				jquery$("#printContent").hide();
			}
		});
	}

	function printDataFloor(){
		var checkStatus = table.checkStatus('scheduleTabId');
		$("#carrierCode").val("");
		var data = checkStatus.data;
		if(data.length==0){
			layer.alert('未选中行',{icon: 2});
			return false;
		}
		$.ajax({
			type: 'POST',
			async: false,
			url: wmsContextPath+"receiveWork/printFloorData",
			dataType: "json",
			data:JSON.stringify(data),
			contentType : 'application/json',
			success: function(result){
				if(result.code==0){
					$("#printContent").show();
					var data = result.data;
					if(data!=null&&JSON.stringify(data)!='{}'){
						var getTpl = stockFloorPrint.innerHTML
						,view = document.getElementById('printContent');
						laytpl(getTpl).render(data, function(html){
						view.innerHTML = html;
						});
						var text="";
						for(var item in data){
						text = data[item][0].carrierCode;
						jquery$('#barcode_'+item).empty().barcode(text, "code128",{//code128为条形码样式
								output:'css',
								color: '#000000',
								barWidth: 3,        //单条条码宽度
								barHeight: 80,     //单体条码高度
								addQuietZone: false
							});
						};
					}else{
						layer.msg("无数据");
						return false;
					}
				}
				jquery$("#printContent").jqprint({importCSS:true});
				jquery$("#printContent").hide();
			}
		});
	}
</script>



	<!--打印内容-->
<div style="display: none;">
	<div id="printContent"></div>
</div>
<script type="text/html" id="stockPrint">
{{#  layui.each(d, function(index, item){ }}
	<div class='main' style='page-break-before:always; margin:0 auto; padding:20px 15px 20px 35px; width:168mm; height:100mm; background: #fff;line-height:50px;font-family: 'Microsoft YaHei', 'Open Sans', sans-serif;font-size:40px;'>
	<div class='top' style='height:16mm;'>
		<h1 style='font-size:30px; margin:0; text-align:center'>物料标签</h1>
	</div>
	<table style="height:96mm;width:168mm;">
		<tr style="height:8mm;"><td style="width:45%;">物料凭证号：{{item.voucherNo}}</td><td style="width:30%;">凭证行项目号：{{item.voucherItemNo}}</td><td rowspan="4">
			<img id="image_{{index}}" width="120px" height="120px" align="right">
			<canvas id="canvas_{{index}}" height="120px" width="120px" style="display: none "></canvas></td>
		</tr>
		<tr style="height:8mm;"><td colspan="2">检验批号：{{item.inspectBatchNo}}</td></tr>
		<tr style="height:8mm;"><td colspan="2"><h2 style="font-size:30px;">物料号：<b>{{item.materialCode}}</b></h2></td></tr>
		<tr style="height:8mm;"><td colspan="2">物料描述：{{item.materialDesc}}</td></tr>
		<tr style="height:8mm;"><td colspan="2">载具编号：{{item.carrierCode}}</td></tr>
		<tr style="height:8mm;"><td>数量/单位：{{item.accountCount}}/{{item.materialUnit}}</td><td  colspan="2">收货者：{{item.userName}}</td></tr>
		<tr style="height:8mm;"><td>保质期：{{item.expireDate}}</td><td colspan="2">仓库标识：{{item.storageLocation}}</td></tr>
		<tr style="height:8mm;"><td colspan="2">供应商名称：{{item.supplierName}}</td><td>工厂：{{item.factory}}</td></tr>
		<tr style="height:8mm;"><td colspan="3">序列号：{{item.serialCode}}</td></tr>
		<tr style="height:8mm;"><td colspan="1">批次号：{{item.batchNo}}</td><td colspan="2" rowspan="3">
			<div style="float: right; height: 35mm; width: 75mm; margin-top: -6%;  border: 2px solid; text-align: center; line-height: 35mm">质检贴标处</div></td></tr>
		<tr style="height:8mm;"><td colspan="1">入库日期：{{item.passTime}}</td></tr>
		<tr style="height:8mm;"><td colspan="1">制造商：{{item.manufacturer}}</td></tr>
	</table>
	</div>
   {{#  }); }}
</script>
<script type="text/html" id="stockFloorPrint">
	{{#  layui.each(d, function(index, item){ }}
	{{#
	var indexArray = index.split("_");
	var  indexOne = indexArray[0];
	var  indexTwo = indexArray[1];
	var carrierCode =$("#carrierCode").val();
	if(indexOne==carrierCode){

	}}
	<div style=" width:210mm;">
		<div class="layui-fluid" >
			<table  style="width: 90%;" >
				<tr style="height:40px;"><td><span style="font-size:20px;">物料凭证号：{{item[0].voucherNo}}</span></td><td><span style="font-size:20px;">工厂：{{item[0].factory}}</span></td></tr>
				<tr style="height:40px;"><td><span style="font-size:20px;">仓储类型：</span></td><td><span style="font-size:20px; ">入库日期：{{item[0].passTime}}</span></td></tr>
				<tr style="height:40px;"><td><span style="font-size:20px;">供应商名称：{{item[0].supplierName}}</span></td><td><span style="font-size:20px;">收货者：{{item[0].userName}}</span></td></tr>
			</table>
		</div>
		<div class="layui-fluid" >
			<table style="border: 1px solid black;   width: 90%;  border-collapse:collapse;   font-size:18px;">
				<th style="border: 1px solid black;  padding-left:5px;height:40px;">序号</th>
				<th style=  "border: 1px solid black;  padding-left:5px;">物料号</th>
				<th style=  "border: 1px solid black;  padding-left:5px;">旧物料号</th>
				<th style=  "border: 1px solid black;  padding-left:5px;">物料描述</th>
				<th style=  "border: 1px solid black;  padding-left:5px;">数量</th>
				<th style=  "border: 1px solid black;  padding-left:5px;">单位</th>
				<th style=  "border: 1px solid black;  padding-left:5px;">批次</th>
				<th style=  "border: 1px solid black;  padding-left:5px;">序列号</th>
				<th style=  "border: 1px solid black;  padding-left:5px;">检验批号</th>
				{{#  layui.each(item, function(index1, item1){ }}
				<tr style="height:40px;"><td style="border: 1px solid black;  padding-left:5px;">{{index1+1}}</td><td style=  "border: 1px solid black;  padding-left:5px;">{{item1.materialCode}}</td><td style=  "border: 1px solid black;  padding-left:5px;">&nbsp;</td><td style=  "border: 1px solid black;  padding-left:5px;">{{item1.materialDesc}}</td><td style=  "border: 1px solid black;  padding-left:5px;">{{item1.accountCount}}</td><td style=  "border: 1px solid black;  padding-left:5px;">{{item1.materialUnit}}</td><td style=  "border: 1px solid black;  padding-left:5px;">{{item1.batchNo}}</td><td style=  "border: 1px solid black;  padding-left:5px;">{{item1.serialCode}}</td><td style=  "border: 1px solid black;  padding-left:5px;">{{item1.inspectBatchNo}}</td></tr>
				{{#  }); }}
			</table>
		</div>
	</div>
	{{#  }else {
	$("#carrierCode").val(indexOne);
	}}
	<div style="page-break-before:always;">
		<div class="layui-fluid">
			<table style="width:780px;">
			<tr style="height:80px;">
				<td align="center" style="width:260px;text-align:left;"><span style="font-size:40px; margin:0;">点收物料清单</span></td>
				<td colspan="2" style="text-align:reght;"><span style="float:left;margin-top:55px; font-size:20px">载具:</span><div id="barcode_{{index}}" align="right"></div></td>
			</tr>
			<tr style="height:40px;">
				<td><span style="font-size:20px;width:250px;">物料凭证号：{{item[0].voucherNo}}</span></td>
				<td><span style="font-size:20px;width:250px;">工厂：{{item[0].factory}}</span></td>
				<td><span style="font-size:20px;width:250px;">项目编号：{{item[0].factory}}</span></td>
			</tr>
			<tr style="height:40px;">
				<td><span style="font-size:20px;width:250px;">仓储类型：</span></td>
				<td><span style="font-size:20px;width:250px;">仓位号：</span></td>
				<td><span style="font-size:20px;width:250px;">入库日期：{{item[0].passTime}}</span></td>
			</tr>
			<tr style="height:40px;">
				<td colspan="2"><span style="font-size:20px;width:250px;">供应商名称：{{item[0].supplierName}}</span></td>
				<td><span style="font-size:20px;">收货者：{{item[0].userName}}</span></td>
			</tr>
		  </table>
		</div>
		<div class="layui-fluid" >
			<table style="border: 1px solid black; width:780px;  border-collapse:collapse;  font-size:18px;">
				<th style="border: 1px solid black; width:30px; height:30px;">序号</th>
				<th style="border: 1px solid black; width:70px;">物料号</th>
				<th style="border: 1px solid black; width:80px;">物料描述</th>
				<th style="border: 1px solid black; width:50px;">数量</th>
				<th style="border: 1px solid black; width:30px;">单位</th>
				<th style="border: 1px solid black; width:40px;">批次</th>
				<th style="border: 1px solid black; width:60px;">到期日</th>
				<th style="border: 1px solid black; width:80px;">序列号</th>
				<th style="border: 1px solid black; width:60px;">检验批号</th>
				{{#  layui.each(item, function(index1, item1){ }}
				<tr style="height:30px;">
					<td style="border: 1px solid black; width:30px; text-align:center;">{{index1+1}}</td>
					<td style="border: 1px solid black; width:80px; text-align:center;">{{item1.materialCode}}</td>
					<td style="border: 1px solid black; width:80px; text-align:center;">{{item1.materialDesc}}</td>
					<td style="border: 1px solid black; width:50px; text-align:center;">{{item1.accountCount}}</td>
					<td style="border: 1px solid black; width:30px; text-align:center;">{{item1.materialUnit}}</td>
					<td style="border: 1px solid black; width:40px; text-align:center;">{{item1.batchNo}}</td>
					<td style="border: 1px solid black; width:60px; text-align:center;">{{item1.expireDate}}</td>
					<td style="border: 1px solid black; width:80px; text-align:center;">{{item1.serialCode}}</td>
					<td style="border: 1px solid black; width:60px; text-align:center;">{{item1.inspectBatchNo}}</td>
				</tr>
				{{#  }); }}
			</table>
		</div>
	</div>
	{{#  } }}
{{#  }); }}
</script>
<script type="text/html" id="indexTpl">
	{{d.LAY_TABLE_INDEX+1}}
</script>
<script type="text/javascript">
	var baseContextPath = config.basicInfoConfig.contextPath;
	var wmsContextPath = config.wmsoptConfig.contextPath;
    var layer = layui.layer;
    var table = layui.table;
    var form = layui.form;
    var oldData;
	var laydate = layui.laydate;
    var active = {
        search:function(othis){
            var getime = $('#getTime').val();
			var warehouseCode = layui.formSelects.value('select1', 'value');
			var storageLocation = warehouseCode[0];
			for(j = 1,len=warehouseCode.length; j < len; j++) {
				storageLocation = storageLocation+","+warehouseCode[j];
			}
            //执行重载
            table.reload('scheduleTabId', {
                where:{
                    arrivalCode : $('#arrivalCode').val(),
                    supplierName : $('#supplierName').val(),
                    beginTime:getime.substring(0,20),
                    endTime:getime.substring(22),
                    jobNode : $('#jobNode').val(),
                    teamId : $('#teamId').val(),
                    checkUid : $('#checkUid').val(),
                    materialCode : $('#materialCode').val(),
					storageLocation : storageLocation,
                    isUrgent : $('#isUrgent').val(),
                },
                page : {
                    "curr" : 1
                }
            });
        },
        reset:function(othis){
            $('#arrivalCode').val("");
            $('#supplierName').val("");
            $('#getTime').val("");
            $('#jobNode').val('');
            $('#teamId').val('');
            $('#checkUid').val('');
            $('#materialCode').val('');
            $('#isUrgent').val('');
			layui.formSelects.value('select1', []);
			form.render("select");
        }
    };

    function loadding() {
		//table = layui.table;
		table.render({
			elem:'#scheduleTab',
			method:'POST',
			id:'scheduleTabId',
			header:{"Authorization":'Bearer '+window.localStorage.token},
			url:wmsContextPath+'receiveWork/getReceiveWorkScheduleList',
			cols: [[
				{type:'checkbox',fixed:'left'},
				{field:'arrivalCode',title: '到货通知单号',minWidth:150,fixed:'left'},
				{field:'supplierName',title: '供应商',minWidth:150},
				{field:'isUrgent', title: '紧急状态',width:90},
				{field:'beginReceiveTime', title: '点收开始时间',width:170},
				{field:'endReceiveTime', title: '点收结束时间',width:170},
				{field:'jobNode', title: '状态',width:90},
				{field:'receiveTime', title: '点收用时',width:120},
				{field:'teamName', title: '点收团队',width:120},
				{field:'checkName', title: '点收审核人',width:120},
				{field:'flagSort', title: '标记',width:80,align:'center'},
				{fixed:'right',align:'center',toolbar:'#toolBar',width:240}
			]],
			page: {theme: '#008155'},
			even:true,
			done:function(res,page,count){//列表数据回调函数
				$("#totalNum").val(res.count);	//数据总条数
				//点收状态/紧急状态 select
				var dictType = new Array();
				dictType.push("receive_status");
				dictType.push("is_urgent");
				var option={
					url:baseContextPath+'dictItems/listDictItemByTypes',
					type:'POST',
					dataType:'json',
					contentType: "application/json",
					data:JSON.stringify(dictType),
					success:function(res){
						if(res.code==0){
							dictItems = res.data
							changeItemName(res.data);
							defaultSelect(dictItems);
						}
					}
				};
				$.ajax(option);
			}
		});
		//监听工具条
		table.on('tool(scheduleTabF)', function(obj){
			var eventName = obj.event;			//事件名称
			var clickObj = $(obj.tr[0]);		//当前对象tr

			if(eventName=="detail"){	//详情
				$("#receiveId").val(obj.data.id);			//方便子页面取点收记录的Id
				$("#arrivalId").val(obj.data.arrivalId);	//方便子页面取到货通知单Id
				layer.open({
					type: 2,
					title:'点收作业调度详情',
					offset:'auto',
					maxmin:true,
					area: ['100%', '100%'],
					id: 'receiveWorkScheduleDetail', //防止重复弹出
					content: '/iles/pages/wms/inbound/receiveWorkScheduleDetail.html',
					shade: 0, //不显示遮罩
					yes: function(){
						layer.closeAll();
					}
				});
			}else if(eventName=="update"){	//编辑 receiveId
				if(obj.data.jobNode == '06' || obj.data.jobNode == '07'){
					$("#someArrivalValue").val(obj.data.arrivalCode+"*"+obj.data.supplierName);
					$("#receiveId").val(obj.data.id);	//方便子页面取点收记录的Id
					$("#arrivalId").val(obj.data.arrivalId);	//方便子页面取到货通知单Id
					layer.open({
						type: 2,
						title:'点收作业调度编辑',
						maxmin:true,
						area: ['700px', '500px'],
						id: 'updateReceiveWorkSchedule', //防止重复弹出
						content: '/iles/pages/wms/inbound/receiveWorkScheduleUpdate.html',
						shade: 0, //不显示遮罩
						yes: function(){
							layer.closeAll();
						}
					});
				}else{
					layer.alert('只有待分配和待点收可以编辑！',{icon: 2});
					return false;
				}
			}else if(eventName=="moveUp"){	//上移
				if(clickObj.attr("data-index") == "0"){
					layer.alert('首行禁止上移',{icon: 2});
					return false;
				}else{
					if(obj.data.jobNode == '08'){
						layer.alert('点收中禁止上移',{icon: 2});
						return false;
					}else if(obj.data.jobNode == '09'){
						layer.alert('已点收禁止上移',{icon: 2});
						return false;
					}else if(obj.data.jobNode == '10'){
						layer.alert('审核通过禁止上移',{icon: 2});
						return false;
					}else if(obj.data.jobNode >= '12'){
						layer.alert('点收关闭禁止上移',{icon: 2});
						return false;
					}else{
						$.ajax({
							type: 'POST',
							async: false,
							url: wmsContextPath+"receiveWork/dataMoveUpOrDown?dataId="+obj.data.id+"&type=up",
							dataType: "json",
							success: function(res){
								if(res.msg == "成功!"){
									table.reload('scheduleTabId');
								}else{
									layer.alert('上移失败',{icon: 2});
								}
							}
						});
					}
				}
			}else if(eventName=="moveDown"){	//下移
				if(clickObj.attr("data-index") == $("#totalNum").val()-1){
					layer.alert('末行禁止下移',{icon: 2});
					return false;
				}else{
					if(obj.data.jobNode == '08'){
						layer.alert('点收中禁止下移',{icon: 2});
						return false;
					}else if(obj.data.jobNode == '09'){
						layer.alert('已点收禁止下移',{icon: 2});
						return false;
					}else if(obj.data.jobNode == '10'){
						layer.alert('审核通过禁止下移',{icon: 2});
						return false;
					}else if(obj.data.jobNode >= '12'){
						layer.alert('点收关闭禁止下移',{icon: 2});
						return false;
					}else{
						$.ajax({
							type: 'POST',
							async: false,
							url: wmsContextPath+"receiveWork/dataMoveUpOrDown?dataId="+obj.data.id+"&type=down",
							dataType: "json",
							success: function(res){
								if(res.msg == "成功!"){
									table.reload('scheduleTabId');
								}else{
									layer.alert('下移失败',{icon: 2});
								}
							}
						});
					}
				}
			}
		});
		$('.layui-btn-container button').on('click', function(){
			var othis = $(this), method = othis.data('method');
			active[method] ? active[method].call(this, othis) : '';
		});
		initWarehouseMultiSelect("warehouseCode","select1","0",null);
		laydate.render({
			elem: '#getTime',
			type: 'datetime',
			range: true
		});
		$("#hide_div").click(function(obj){
			$("#title_div").hide();
			$("#show_div").show();
		});
		$("#show_div").click(function(obj){
			$("#title_div").show();
			$("#show_div").hide();
		});
		//加载点收团队select
		$.ajax({
			type: 'POST',
			async: false,
			url: wmsContextPath+"receiveWork/getReceiveTeam",
			dataType: "json",
			success: function(res){
				$("#teamId").append(res.data);
			}
		});
		//加载点收审核人
		$.ajax({
			type: 'POST',
			async: false,
			url: wmsContextPath+"receiveWork/getReceivePeople",
			dataType: "json",
			contentType : 'application/json',
			success: function(result){
				$("#checkUid").append(result.data);
			}
		});
		form.render();
    }

	function helpDoc(){
		layer.open({
			  type: 1,
			  area: ['30%', '30%'],
			  title:'',
			  content: $('#helpDocDiv')//这里content是一个DOM，注意：最好该元素要存放在body最外层，否则可能被其它的相对元素所影响
			  ,yes: function(){
				  layer.closeAll();
			   },cancel: function(index, layero){
					$("#helpDocDiv").hide();
			   }
		});
		 $("#helpDocDiv").parent().addClass("layui-layer-content-new");
	};
	//加载点收状态select
	function defaultSelect(dictItems){
		if(dictItems && dictItems.length>0){
			if($("#jobNode").find("option").length==1){
				for(var i=0;i<dictItems.length;i++){
					if(dictItems[i].dictTypeId=="receive_status"){
						$("#jobNode").append("<option value="+dictItems[i].itemValue+">"+dictItems[i].itemName+"</option>");
					}
				}
				form.render('select');
			}
			if($("#isUrgent").find("option").length==1){
				for(var i=0;i<dictItems.length;i++){
					if(dictItems[i].dictTypeId=="is_urgent"){
						$("#isUrgent").append("<option value="+dictItems[i].itemValue+">"+dictItems[i].itemName+"</option>");
					}
				}
				form.render('select');
			}
		}
	}
	function changeItemName(data){
		//table列 点收状态 回显汉字
		$("[data-field='jobNode']").children().each(function(){
			for(var i=0;i<data.length;i++){
				if(data[i].dictTypeId=="receive_status" && data[i].itemValue==$(this).text().trim()){
					$(this).text(data[i].itemName);
				}
			}
		});
		//table列紧急状态列回显汉字
		$("[data-field='isUrgent']").children().each(function(i,e){
			if(i>0){
				if($(e).text()==1){
					$(e).css("color","red");
				}
			}
			for(var i=0;i<data.length;i++){
				if(data[i].dictTypeId=="is_urgent" && data[i].itemValue==$(this).text().trim()){
					$(this).text(data[i].itemName);
				}
			}
		});
		$("[data-field='flagSort']").children().each(function(i,e){
			if(i>0){
				if($(e).text()==''){
					$(e).text('--');
				}else if($(e).text()=='1'){
					$(e).text('↑');
				}else if($(e).text()=='2'){
					$(e).text('↓');
				}
			}
		});
	}
</script>

<script type="text/html" id="toolBar">
	<a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">详情</a>
	<a class="layui-btn layui-btn-xs" lay-event="update">编辑</a>
	<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="moveUp">上移</a>
	<a class="layui-btn layui-btn-xs" lay-event="moveDown">下移</a>
</script>
<div id="helpDocDiv" style="display:none">
	<div class="layui-col-md12">
		<div class="layui-card" style="background: linear-gradient(#001a47,#022558);">
			<div class="layui-card-header" style="color: #c0dcfe;border-bottom: 1px solid #2a69c7;font-size: 22px;padding-top: 22px;"></div>
			<div class="layui-card-body"  style="border-bottom: 1px solid #2a69c7;color: #c0dcfe;">
				<p>查询节点在开始点收到点收关闭区间的所有到货通知单,可通过筛选条件进行筛选</p>
			</div>
		</div>
	</div>
</div>
</html>
