<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>上架作业管理</title>
	<meta name="renderer" content="webkit|ie-comp|ie-stand">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<meta http-equiv="Cache-Control" content="no-siteapp" />
	<link rel="stylesheet" href="/iles/pages/layui/css/layui.css"  type="text/css" />
	<link rel="stylesheet" href="/iles/pages/css/layui_extend.css"  media="all">
	<link rel="stylesheet" href="/iles/pages/layui/css/modules/layer/default/layer.css"  type="text/css" />
	<link rel="stylesheet" href="/iles/pages/layui/css/formSelects-v4.css" />
</head>
<div id="bodyDiv">

</div>
<script type="text/html" id="bodyTpl">
	<input type="hidden" name="storageBinCode" id="storageBinCode">
	<input type="hidden" name="id" id="upperId">
	<div class="layui-fluid">
		<div class="layui-row layui-form">
			<div class="layui-col-md2">
				<label class="layui-form-label">仓库名称:</label>
				<div class="layui-input-inline">
					<select id="warehouseName_search" xm-select="warehouseCodeSelect" xm-select-show-count="1">
						<option value="">请选择</option>
					</select>
				</div>
			</div>
			<div class="layui-col-md2">
				<label class="layui-form-label">上架日期:</label>
				<div class="layui-input-inline layui-form">
					<input type="text" class="layui-input"  id="upperTime_search" placeholder="请选择上架日期">
				</div>
			</div>
			<div class="layui-col-md2">
				<label class="layui-form-label">库位类型</label>
				<div class="layui-input-inline">
					<select id="upperType_search" xm-select="upperTypeSelect" xm-select-show-count="1">
						<option value="">请选择</option>
					</select>
				</div>
			</div>
			<div class="layui-col-md2">
				<label class="layui-form-label">上架库位:</label>
				<div class="layui-input-inline">
					<input type="text"  id="positionCode_search" class="layui-input" placeholder="请输入上架库位">
				</div>
			</div>
			<div class="layui-col-md2">
				<label class="layui-form-label">货物名称:</label>
				<div class="layui-input-inline">
					<input type="text" name="materialDesc" id="materialDesc" class="layui-input" placeholder="请输入货物名称">
				</div>
			</div>
			<div class="layui-col-md2">
				<label class="layui-form-label">上架状态</label>
				<div class="layui-input-inline">
					<select id="status_search" xm-select="statusSelect" xm-select-show-count="1">
						<option value="">请选择</option>
					</select>
				</div>
			</div>
			<div class="layui-btn-container nav-" style="text-align: right;">
				{{# if(d.search==null || d.search=="true"){ }}
				<button class="layui-btn layui-btn-normal layui-btn-sm" data-method="search" id="search" type="button"><i
						class="layui-icon layui-icon-search"></i>查询
				</button>
				<button class="layui-btn layui-btn-normal layui-btn-sm" data-method="reset" id="reset" type="button"><i
						class="layui-icon  layui-icon-reset"></i>重置
				</button>
				{{# } }}
			</div>
		</div>

	</div>
	<table id="scheduleTab" lay-filter="scheduleTabF"></table>
</script>
<script src="/iles/pages/layui/layui.all.js" charset="UTF-8"></script>
<script src="/iles/pages/js/serverPathConfig.js" charset="UTF-8"></script>
<script src="/iles/pages/js/loginInspect.js" charset="UTF-8"></script>
<script src="/iles/pages/js/common/warehouseSelect.js" charset="UTF-8"></script>
<script type="text/javascript">

	var $ = layui.$;
	var layer = layui.layer;
	var table = layui.table;
	var form = layui.form;
	var laydate = layui.laydate;
	var oldData;
    var wmsContextPath = config.wmsConfig.contextPath;

	var active = {
		search:function(othis){
			var upperType = layui.formSelects.value('upperTypeSelect', 'valueStr');
			var status = layui.formSelects.value('statusSelect', 'valueStr');
			var warehouseCode = layui.formSelects.value('warehouseCodeSelect', 'name');
			//执行重载
			table.reload('scheduleTabId', {
				where:{
					warehouseCode :warehouseCode,
					upperTaskCode : $("#upperTaskCode_search").val(),
					upperTimeStr : $("#upperTime_search").val(),
					upperType : upperType,
					positionCode : $("#positionCode_search").val(),
					materialDesc : $('#materialDesc').val(),
					status:status,
				},
				page : {
					"curr" : 1
				}
			});
		},
		reset:function(othis){
			$('#upperTaskCode_search').val("");
			$('#upperTime_search').val('');
			layui.formSelects.value('upperTypeSelect', []);
			$('#positionCode_search').val('');
			$('#materialDesc').val('');
			layui.formSelects.value('statusSelect', []);
			layui.formSelects.value('warehouseCodeSelect', []);
			form.render("select");
		}
	};

	function loadding() {
		table.render({
			elem:'#scheduleTab',
			id:'scheduleTabId',
			url:wmsContextPath+'upperFrameRecord/listUpperFrameRecord',
			cols: [[
				{type: 'numbers', title: '序号'},
				{field:'warehouseName',title: '仓库名称',align:'center',minWidth:100},
				{field:'clientName', title: '客户名称',align:'center',minWidth:120},
				{field:'materialDesc', title: '货物名称',align:'center',minWidth:140},
				{field:'materialNum', title: '上架数量',align:'center',minWidth:120},
				{field:'materialUnit', title: '单位',align:'center',minWidth:100},
				{field:'batchNo', title: '批次号',align:'center',minWidth:120},
				{field:'status', title: '上架状态',align:'center',minWidth:120,templet(d){
						if(d.status=='0'){
							return '待上架';
						}else if(d.status=='1'){
							return '上架完成';
						}else{
							return d.status;
						}
					}},
				{field:'positionCode', title: '上架库位',align:'center',minWidth:160},
				{field:'upperNumber', title: '库位数量',align:'center',minWidth:160},
				{field:'upperUpperTime', title: '上架日期',align:'center',minWidth:120},
				{field:'upperUpperName', title: '上架人员',align:'center',minWidth:90},
				{field:'upperType', title: '上架类型',align:'center',minWidth:90,templet(d){
					if(d.upperType=='0'){
						return '合格';
					}else if(d.upperType=='1'){
						return '不合格';
					}else{
						return d.upperType;
					}
				}}
			]],
			page: {theme: '#008155'},
			height: '500px',
			even:true,
			done:function(res,page,count){//列表数据回调函数
			}
		});
		//时间选择器
		laydate.render({
			elem: '#upperTime_search',
			type: 'date',
			trigger: 'click',
			range: true
		});

		$('.layui-btn-container button').on('click', function(){
			var othis = $(this), method = othis.data('method');
			active[method] ? active[method].call(this, othis) : '';
		});
		initWarehouseMultiSelect("warehouseName_search","warehouseCodeSelect","1",'');
		initUpperType();
		initStatus();
	}

	//初始化库位类型下拉框
	function initUpperType() {
		var optoinArray = [{name: '合格', value: '0'}, {name: '不合格', value: '1'}];
		layui.formSelects.data("upperTypeSelect", 'local', {
			arr: optoinArray
		});
	}

	//初始化上架状态下拉框
	function initStatus() {
		var optoinArray = [{name: '待上架', value: '0'}, {name: '上架完成', value: '1'}];
		layui.formSelects.data("statusSelect", 'local', {
			arr: optoinArray
		});
	}
</script>
</html>
